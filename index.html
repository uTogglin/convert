<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <title>Convert to it!</title>
</head>
<body>

  <input id="file-input" type="file" multiple>

  <a id="commit-id" href="https://github.com/p2r3/convert"></a>

  <!-- Top bar -->
  <header id="top-bar">
    <div id="top-bar-left">
      <button id="back-to-home" class="hidden" title="Back to home">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
      </button>
      <h1 id="logo">Convert<span class="accent">.</span>it</h1>
    </div>
    <div id="top-bar-right">
      <button id="theme-toggle" title="Toggle dark/light mode">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
      </button>
      <button id="settings-toggle" title="Settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </svg>
      </button>
    </div>
  </header>

  <!-- Home page -->
  <section id="home-page">
    <div class="home-hero">
      <h2 class="home-title">What do you want to do?</h2>
      <p class="home-subtitle">Pick a tool to get started — everything runs locally in your browser.</p>
    </div>
    <div class="home-grid">
      <button class="home-card" data-tool="convert">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="16 3 21 3 21 8"></polyline>
            <line x1="4" y1="20" x2="21" y2="3"></line>
            <polyline points="21 16 21 21 16 21"></polyline>
            <line x1="15" y1="15" x2="21" y2="21"></line>
            <line x1="4" y1="4" x2="9" y2="9"></line>
          </svg>
        </div>
        <h3>Convert</h3>
        <p>Change files between 200+ formats — images, video, audio, documents, and more.</p>
        <span class="home-card-tag">Most popular</span>
      </button>
      <button class="home-card" data-tool="compress">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <line x1="4" y1="6" x2="20" y2="6"></line>
            <line x1="6" y1="10" x2="18" y2="10"></line>
            <line x1="8" y1="14" x2="16" y2="14"></line>
            <line x1="10" y1="18" x2="14" y2="18"></line>
          </svg>
        </div>
        <h3>Compress</h3>
        <p>Shrink video file sizes with H.264, H.265, or VP9 — target a specific size or just re-encode.</p>
        <span class="home-card-tag">Video</span>
      </button>
      <button class="home-card" data-tool="image">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <polyline points="21 15 16 10 5 21"></polyline>
          </svg>
        </div>
        <h3>Image Tools</h3>
        <p>Remove backgrounds, rescale dimensions, strip metadata — all processed locally.</p>
        <span class="home-card-tag">AI-powered</span>
      </button>
    </div>
  </section>

  <!-- Settings drawer -->
  <div id="settings-drawer" class="hidden">
    <div class="settings-section">
      <h3>Accent Color</h3>
      <div id="accent-colors">
        <button class="color-dot active" data-color="#6C5CE7" style="background:#6C5CE7" title="Purple"></button>
        <button class="color-dot" data-color="#0984E3" style="background:#0984E3" title="Blue"></button>
        <button class="color-dot" data-color="#00B894" style="background:#00B894" title="Green"></button>
        <button class="color-dot" data-color="#E17055" style="background:#E17055" title="Coral"></button>
        <button class="color-dot" data-color="#FDCB6E" style="background:#FDCB6E" title="Yellow"></button>
        <button class="color-dot" data-color="#E84393" style="background:#E84393" title="Pink"></button>
        <button class="color-dot" data-color="#FF6B6B" style="background:#FF6B6B" title="Red"></button>
        <button class="color-dot" data-color="#1C77FF" style="background:#1C77FF" title="Classic Blue"></button>
      </div>
      <div class="custom-slots-row">
        <span class="custom-slots-label">Custom</span>
        <button class="color-dot custom-slot" id="custom-slot-1" data-slot="1" title="Custom slot 1"></button>
        <button class="color-dot custom-slot" id="custom-slot-2" data-slot="2" title="Custom slot 2"></button>
        <button class="color-dot custom-slot" id="custom-slot-3" data-slot="3" title="Custom slot 3"></button>
      </div>
      <div id="custom-color-row">
        <input type="color" id="custom-accent" value="#6C5CE7">
        <button id="save-custom-color" title="Save current color to a slot">Save</button>
      </div>
    </div>
    <div class="settings-section">
      <h3>Toggles</h3>
      <button id="mode-button">Advanced mode</button>
      <hr class="settings-divider">
      <button id="auto-download-toggle">Auto-download: On</button>
      <button id="archive-multi-toggle">Multi-file output: Archive</button>
      <hr class="settings-divider">
      <button id="remove-bg-toggle">Remove background: Off</button>
      <button id="bg-mode-toggle" class="hidden">Mode: Local</button>
      <button id="bg-correction-toggle" class="hidden">Correction: Off</button>
      <div id="bg-api-key-row" class="hidden">
        <input type="password" id="bg-api-key" placeholder="remove.bg API key" autocomplete="off">
        <p class="settings-hint">Get a free key at <a href="https://www.remove.bg/api" target="_blank" rel="noopener">remove.bg/api</a>. Images are sent to remove.bg servers.</p>
      </div>
      <hr class="settings-divider">
      <button id="rescale-toggle">Rescale images: Off</button>
      <div id="rescale-options" class="hidden">
        <div class="rescale-inputs">
          <input type="number" id="rescale-width" placeholder="Width" min="1">
          <span class="rescale-x">&times;</span>
          <input type="number" id="rescale-height" placeholder="Height" min="1">
        </div>
        <label class="rescale-lock"><input type="checkbox" id="rescale-lock-ratio" checked> Lock aspect ratio</label>
      </div>
      <button id="privacy-toggle">Privacy mode: Off</button>
    </div>
    <div class="settings-section">
      <h3>Compression</h3>
      <button id="compress-toggle">Compress: Off</button>
      <div id="compress-options" class="hidden">
        <div class="compress-grid">
          <div class="compress-grid-left">
            <p class="settings-hint">Re-encodes video at best quality. Set a target size to also constrain file size.</p>
            <div class="compress-presets">
              <span class="compress-presets-label">Codec</span>
              <div class="compress-preset-grid">
                <button class="codec-preset-btn selected" data-codec="h264">H.264<span class="compress-preset-note">Compatible</span></button>
                <button class="codec-preset-btn" data-codec="h265">H.265<span class="compress-preset-note">Smaller files</span></button>
              </div>
            </div>
            <p id="codec-hint" class="settings-hint hidden">H.265 produces ~50% smaller files but may not play on older devices. Falls back to H.264 if encoding stalls.</p>
            <div class="compress-presets">
              <span class="compress-presets-label">Speed</span>
              <div class="compress-preset-grid">
                <button class="speed-preset-btn" data-speed="fast">Fast<span class="compress-preset-note">Fastest</span></button>
                <button class="speed-preset-btn selected" data-speed="balanced">Balanced<span class="compress-preset-note">Default</span></button>
                <button class="speed-preset-btn" data-speed="quality">Quality<span class="compress-preset-note">Slowest</span></button>
              </div>
            </div>
          </div>
          <div class="compress-grid-right">
            <button id="webm-mode-toggle">WebM mode: Off</button>
            <p id="webm-hint" class="settings-hint hidden">Tries VP9 first for faster, smaller files. Output will be .webm.</p>
            <div class="compress-size-row">
              <input type="number" id="compress-target-mb" placeholder="Target MB (optional)" min="0.1" step="0.1">
              <span class="compress-unit">MB</span>
            </div>
            <div class="compress-presets">
              <span class="compress-presets-label">Discord</span>
              <div class="compress-preset-grid">
                <button class="compress-preset-btn" data-size="10">10 MB<span class="compress-preset-note">Free</span></button>
                <button class="compress-preset-btn" data-size="50">50 MB<span class="compress-preset-note">Basic</span></button>
                <button class="compress-preset-btn" data-size="500">500 MB<span class="compress-preset-note">Nitro</span></button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="settings-section">
      <h3>Error Log <span id="log-badge" class="log-badge hidden">0</span></h3>
      <p class="settings-hint">Captured <code>console.error</code> and <code>console.warn</code> messages.</p>
      <div id="app-log-list" class="app-log-list"><p class="app-log-empty">No errors or warnings captured yet.</p></div>
      <div class="app-log-actions">
        <button id="copy-log-btn">Copy log</button>
        <button id="clear-log-btn">Clear log</button>
      </div>
    </div>
  </div>

  <div id="file-area">
    <h2>Click to add your file</h2>
    <p id="drop-hint-text">or drag and drop it here</p>
  </div>

  <div id="archive-panel">
    <span class="archive-panel-title">Archive uploaded files</span>
    <div class="archive-fmt-grid">
      <button class="archive-fmt-btn" data-format="zip">.zip</button>
      <button class="archive-fmt-btn" data-format="7z">.7z</button>
      <button class="archive-fmt-btn" data-format="tar">.tar</button>
      <button class="archive-fmt-btn" data-format="tgz">.tar.gz</button>
      <button class="archive-fmt-btn" data-format="gz">.gz <span class="archive-fmt-note">per file</span></button>
    </div>
    <button id="create-archive-btn" class="disabled">Create Archives</button>
  </div>

  <div id="output-tray">
    <div class="output-tray-header">
      <span>Converted Files</span>
      <div class="output-tray-actions">
        <button id="download-all-btn">Download All</button>
        <button id="clear-output-btn">Clear</button>
      </div>
    </div>
    <div id="output-tray-grid"></div>
  </div>

  <div id="format-containers">

    <div id="from-container" class="format-container">
      <h2>Convert from:</h2>
      <input type="text" id="search-from" class="search" placeholder="Search">
      <div id="from-list" class="format-list">

      </div>
    </div>

    <div id="to-container" class="format-container">
      <h2>Convert to:</h2>
      <input type="text" id="search-to" class="search" placeholder="Search">
      <div id="to-list" class="format-list">

      </div>
    </div>

  </div>

  <button id="convert-button" class="disabled">Convert</button>

  <div id="popup-bg"></div>
  <div id="popup">
    <h2>Loading tools...</h2>
  </div>

  <script type="module" src="src/main.ts"></script>

</body>
</html>
