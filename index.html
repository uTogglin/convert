<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <title>Convert to it!</title>
</head>
<body>

  <input id="file-input" type="file" multiple>

  <a id="commit-id" href="https://github.com/p2r3/convert"></a>

  <!-- Top bar -->
  <header id="top-bar">
    <div id="top-bar-left">
      <button id="back-to-home" class="hidden" title="Back to home">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
      </button>
      <h1 id="logo">Convert<span class="accent">.</span>it</h1>
    </div>
    <div id="top-bar-right">
      <button id="theme-toggle" title="Toggle dark/light mode">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
      </button>
      <button id="logs-toggle" title="Logs">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
        <span id="log-badge" class="log-badge hidden">0</span>
      </button>
      <button id="settings-toggle" title="Settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </svg>
      </button>
    </div>
  </header>

  <!-- Home page -->
  <section id="home-page">
    <div class="home-hero">
      <h2 class="home-title">What do you want to do?</h2>
      <p class="home-subtitle">Pick a tool to get started — everything runs locally in your browser.</p>
    </div>
    <div class="home-grid">
      <button class="home-card" data-tool="convert">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="16 3 21 3 21 8"></polyline>
            <line x1="4" y1="20" x2="21" y2="3"></line>
            <polyline points="21 16 21 21 16 21"></polyline>
            <line x1="15" y1="15" x2="21" y2="21"></line>
            <line x1="4" y1="4" x2="9" y2="9"></line>
          </svg>
        </div>
        <h3>Convert</h3>
        <p>Change files between 200+ formats — images, video, audio, documents, and more.</p>
        <span class="home-card-tag">Most popular</span>
      </button>
      <button class="home-card" data-tool="compress">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <line x1="4" y1="6" x2="20" y2="6"></line>
            <line x1="6" y1="10" x2="18" y2="10"></line>
            <line x1="8" y1="14" x2="16" y2="14"></line>
            <line x1="10" y1="18" x2="14" y2="18"></line>
          </svg>
        </div>
        <h3>Compress</h3>
        <p>Shrink video file sizes with H.264, H.265, or VP9 — target a specific size or just re-encode.</p>
        <span class="home-card-tag">Video</span>
      </button>
      <button class="home-card" data-tool="image">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <polyline points="21 15 16 10 5 21"></polyline>
          </svg>
        </div>
        <h3>Image Tools</h3>
        <p>Remove backgrounds, rescale dimensions, strip metadata — all processed locally.</p>
        <span class="home-card-tag">AI-powered</span>
      </button>
      <button class="home-card" data-tool="video">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="23 7 16 12 23 17 23 7"></polygon>
            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
          </svg>
        </div>
        <h3>Video Editor</h3>
        <p>Trim, crop, merge, remove audio, and manage subtitles — all processed in your browser.</p>
        <span class="home-card-tag">New</span>
      </button>
      <button class="home-card" data-tool="speech">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
            <line x1="12" y1="19" x2="12" y2="23"></line>
            <line x1="8" y1="23" x2="16" y2="23"></line>
          </svg>
        </div>
        <h3>Text & Speech</h3>
        <p>Read text aloud or transcribe speech to text — all processed locally in your browser.</p>
        <span class="home-card-tag">New</span>
      </button>
    </div>
  </section>

  <!-- Settings modal -->
  <div id="settings-overlay" class="hidden"></div>
  <div id="settings-modal" class="hidden">
    <aside class="sm-sidebar">
      <h2 class="sm-title">Settings</h2>
      <nav class="sm-nav">
        <button class="sm-nav-btn active" data-panel="convert">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
          General
        </button>
        <button class="sm-nav-btn" data-panel="compress">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="6" x2="20" y2="6"></line><line x1="6" y1="10" x2="18" y2="10"></line><line x1="8" y1="14" x2="16" y2="14"></line><line x1="10" y1="18" x2="14" y2="18"></line></svg>
          Compress
        </button>
        <button class="sm-nav-btn" data-panel="image">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
          Image Tools
        </button>
        <button class="sm-nav-btn" data-panel="video">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg>
          Video Editor
        </button>
        <button class="sm-nav-btn" data-panel="speech">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
          Text & Speech
        </button>
      </nav>
    </aside>
    <main class="sm-content">
      <button id="settings-close-btn" class="modal-close-btn" title="Close">&times;</button>

      <!-- General panel -->
      <div class="sm-panel active" data-panel="convert">
        <h3 class="sm-panel-title">General</h3>
        <div class="sm-group">
          <span class="sm-label">Mode</span>
          <button id="mode-button" class="sm-btn">Advanced mode</button>
        </div>
        <div class="sm-group">
          <span class="sm-label">Output</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Auto-download</span>
            <button id="auto-download-toggle" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Archive multi-file output</span>
            <button id="archive-multi-toggle" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Apply edits to all files</span>
            <button id="apply-all-toggle" class="sm-switch" role="switch"></button>
          </label>
          <p class="sm-hint">When enabled, current settings are applied to every loaded file during processing.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Privacy</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Privacy mode</span>
            <button id="privacy-toggle" class="sm-switch" role="switch"></button>
          </label>
        </div>
        <div class="sm-group">
          <span class="sm-label">Accent color</span>
          <div id="accent-colors">
            <button class="color-dot active" data-color="#6C5CE7" style="background:#6C5CE7" title="Purple"></button>
            <button class="color-dot" data-color="#0984E3" style="background:#0984E3" title="Blue"></button>
            <button class="color-dot" data-color="#00B894" style="background:#00B894" title="Green"></button>
            <button class="color-dot" data-color="#E17055" style="background:#E17055" title="Coral"></button>
            <button class="color-dot" data-color="#FDCB6E" style="background:#FDCB6E" title="Yellow"></button>
            <button class="color-dot" data-color="#E84393" style="background:#E84393" title="Pink"></button>
            <button class="color-dot" data-color="#FF6B6B" style="background:#FF6B6B" title="Red"></button>
            <button class="color-dot" data-color="#1C77FF" style="background:#1C77FF" title="Classic Blue"></button>
          </div>
          <div class="custom-slots-row">
            <span class="custom-slots-label">Custom</span>
            <button class="color-dot custom-slot" id="custom-slot-1" data-slot="1" title="Custom slot 1"></button>
            <button class="color-dot custom-slot" id="custom-slot-2" data-slot="2" title="Custom slot 2"></button>
            <button class="color-dot custom-slot" id="custom-slot-3" data-slot="3" title="Custom slot 3"></button>
          </div>
          <div id="custom-color-row">
            <input type="color" id="custom-accent" value="#6C5CE7">
            <button id="save-custom-color" title="Save current color to a slot">Save</button>
          </div>
        </div>
      </div>

      <!-- Compress panel -->
      <div class="sm-panel" data-panel="compress">
        <h3 class="sm-panel-title">Compress</h3>
        <p class="sm-hint">Re-encodes video at best quality. Set a target size to constrain file size.</p>
        <div id="compress-options">
          <div class="sm-group">
            <span class="sm-label">Codec</span>
            <div class="sm-pill-row">
              <button class="codec-preset-btn selected" data-codec="h264">H.264<span class="sm-pill-note">Compatible</span></button>
              <button class="codec-preset-btn" data-codec="h265">H.265<span class="sm-pill-note">Smaller files</span></button>
            </div>
            <p id="codec-hint" class="sm-hint hidden">H.265 produces ~50% smaller files but may not play on older devices.</p>
          </div>
          <div class="sm-group">
            <span class="sm-label">Speed</span>
            <div class="sm-pill-row">
              <button class="speed-preset-btn" data-speed="fast">Fast<span class="sm-pill-note">Fastest</span></button>
              <button class="speed-preset-btn selected" data-speed="balanced">Balanced<span class="sm-pill-note">Default</span></button>
              <button class="speed-preset-btn" data-speed="quality">Quality<span class="sm-pill-note">Slowest</span></button>
            </div>
          </div>
          <div class="sm-group">
            <span class="sm-label">Output format</span>
            <label class="sm-switch-row">
            <span class="sm-switch-label">WebM mode</span>
            <button id="webm-mode-toggle" class="sm-switch" role="switch"></button>
          </label>
            <p id="webm-hint" class="sm-hint hidden">Tries VP9 first for faster, smaller files. Output will be .webm.</p>
          </div>
          <div class="sm-group">
            <span class="sm-label">Target size</span>
            <div class="sm-size-row">
              <input type="number" id="compress-target-mb" placeholder="Target MB (optional)" min="0.1" step="0.1">
              <span class="sm-unit">MB</span>
            </div>
            <select id="compress-preset-select" class="sm-select">
              <option value="">No preset</option>
              <optgroup label="Discord">
                <option value="10">10 MB — Free</option>
                <option value="50">50 MB — Basic</option>
                <option value="500">500 MB — Nitro</option>
              </optgroup>
              <optgroup label="Twitter / X">
                <option value="15">15 MB — Standard</option>
                <option value="512">512 MB — Premium</option>
              </optgroup>
            </select>
          </div>
        </div>
      </div>

      <!-- Image Tools panel -->
      <div class="sm-panel" data-panel="image">
        <h3 class="sm-panel-title">Image Tools</h3>
        <div class="sm-group">
          <span class="sm-label">Background removal</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Remove background</span>
            <button id="remove-bg-toggle" class="sm-switch" role="switch"></button>
          </label>
          <button id="bg-mode-toggle" class="sm-btn hidden">Mode: Local</button>
          <label class="sm-switch-row hidden">
            <span class="sm-switch-label">Correction</span>
            <button id="bg-correction-toggle" class="sm-switch" role="switch"></button>
          </label>
          <div id="bg-api-key-row" class="hidden">
            <input type="password" id="bg-api-key" placeholder="remove.bg API key" autocomplete="off">
            <p class="sm-hint">Get a free key at <a href="https://www.remove.bg/api" target="_blank" rel="noopener">remove.bg/api</a>. Images are sent to remove.bg servers.</p>
          </div>
        </div>
        <div class="sm-group">
          <span class="sm-label">Rescale</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Rescale images</span>
            <button id="rescale-toggle" class="sm-switch" role="switch"></button>
          </label>
          <div id="rescale-options" class="hidden">
            <div class="sm-size-row">
              <input type="number" id="rescale-width" placeholder="Width" min="1">
              <span class="sm-unit">&times;</span>
              <input type="number" id="rescale-height" placeholder="Height" min="1">
            </div>
            <label class="sm-check"><input type="checkbox" id="rescale-lock-ratio" checked> Lock aspect ratio</label>
          </div>
        </div>
      </div>

      <!-- Text & Speech panel -->
      <div class="sm-panel" data-panel="speech">
        <h3 class="sm-panel-title">Text & Speech</h3>
        <div class="sm-group">
          <span class="sm-label">Text to Speech</span>
          <p class="sm-hint">Uses Kokoro 82M neural TTS via ONNX — natural-sounding voices. Model cached on first use (~92 MB).</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Speech to Text</span>
          <p class="sm-hint">Microphone mode uses Web Speech API (requires browser support). File upload uses Whisper AI via Transformers.js — model cached on first use (~41 MB).</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Processing</span>
          <p class="sm-hint">Everything runs locally. No files leave your device.</p>
        </div>
      </div>

      <!-- Video Editor panel -->
      <div class="sm-panel" data-panel="video">
        <h3 class="sm-panel-title">Video Editor</h3>
        <div class="sm-group">
          <span class="sm-label">Trim</span>
          <p class="sm-hint">Cut video with timeline handles or precise time inputs.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Audio</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Remove audio</span>
            <button id="vid-pref-remove-audio" class="sm-switch" role="switch"></button>
          </label>
          <p class="sm-hint">5-band equalizer available per video in the editor sidebar.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Subtitles</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Remove subtitles</span>
            <button id="vid-pref-remove-subs" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Mux as track</span>
            <button id="vid-pref-mux" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Burn onto video</span>
            <button id="vid-pref-burn" class="sm-switch" role="switch"></button>
          </label>
          <p class="sm-hint">Supports SRT, ASS, VTT, and SSA formats.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">AI subtitle generation</span>
          <select id="vid-pref-gen-model" class="sm-select">
            <option value="small">Quality (small model)</option>
            <option value="base">Speed (base model)</option>
          </select>
          <select id="vid-pref-gen-lang" class="sm-select">
            <option value="">Auto-detect</option>
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="nl">Dutch</option>
            <option value="ru">Russian</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="zh">Chinese</option>
            <option value="ar">Arabic</option>
            <option value="hi">Hindi</option>
            <option value="tr">Turkish</option>
            <option value="pl">Polish</option>
            <option value="sv">Swedish</option>
          </select>
          <p class="sm-hint">Whisper via Transformers.js — model cached on first use (~41 MB).</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Processing</span>
          <p class="sm-hint">Runs locally via FFmpeg WASM. No files leave your device.</p>
        </div>
      </div>


    </main>
  </div>

  <!-- Logs overlay + modal -->
  <div id="logs-overlay" class="hidden"></div>
  <div id="logs-popout" class="hidden">
    <button id="logs-close-mobile" class="modal-close-btn" title="Close">&times;</button>
    <div class="logs-popout-header">
      <h3>Error Log</h3>
      <button id="logs-popout-close" title="Close">&times;</button>
    </div>
    <p class="sm-hint" style="margin:0 0 8px">Captured <code>console.error</code> and <code>console.warn</code> messages.</p>
    <div id="app-log-list" class="app-log-list"><p class="app-log-empty">No errors or warnings captured yet.</p></div>
    <div class="app-log-actions">
      <button id="copy-log-btn">Copy log</button>
      <button id="clear-log-btn">Clear log</button>
    </div>
  </div>

  <div id="file-area">
    <h2>Click to add your file</h2>
    <p id="drop-hint-text">or drag and drop it here</p>
  </div>

  <div id="archive-panel">
    <span class="archive-panel-title">Archive uploaded files</span>
    <div class="archive-fmt-grid">
      <button class="archive-fmt-btn" data-format="zip">.zip</button>
      <button class="archive-fmt-btn" data-format="7z">.7z</button>
      <button class="archive-fmt-btn" data-format="tar">.tar</button>
      <button class="archive-fmt-btn" data-format="tgz">.tar.gz</button>
      <button class="archive-fmt-btn" data-format="gz">.gz <span class="archive-fmt-note">per file</span></button>
    </div>
    <button id="create-archive-btn" class="disabled">Create Archives</button>
  </div>

  <div id="output-tray">
    <div class="output-tray-header">
      <span>Converted Files</span>
      <div class="output-tray-actions">
        <button id="download-all-btn">Download All</button>
        <button id="clear-output-btn">Clear</button>
      </div>
    </div>
    <div id="output-tray-grid"></div>
  </div>

  <!-- Compress tool page -->
  <section id="compress-page" class="tool-page hidden">
    <div class="tool-page-header">
      <h2>Compress Video</h2>
      <p>Upload your videos and hit compress. <button class="tool-page-settings-link" data-open-panel="compress">Configure settings</button></p>
    </div>
  </section>

  <!-- Image tools page -->
  <section id="image-page" class="tool-page hidden">
    <!-- Title -->
    <div class="img-page-header">
      <h2>Image Tools</h2>
      <p>Upload images to remove backgrounds, rescale, and strip metadata.</p>
    </div>

    <!-- Canvas column + settings side by side, centered -->
    <div id="img-layout">
      <!-- Left column: canvas + filmstrip + controls -->
      <div id="img-canvas-col">
        <div id="img-canvas">
          <div id="img-drop-prompt">
            <svg class="img-drop-icon" width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            <span class="img-drop-text">Drop image here</span>
            <span class="img-drop-sub">or click to browse</span>
          </div>
          <img id="img-preview" class="hidden" alt="Preview">
        </div>

        <!-- Below canvas: filmstrip, remove bg, before/after -->
        <div id="img-workspace" class="hidden">
          <div class="img-filmstrip">
            <div id="img-filmstrip-grid"></div>
            <button id="img-add-more" class="img-filmstrip-add" title="Add more images">+</button>
          </div>
          <div class="img-below-controls">
            <label class="img-removebg-row">
              <span>Remove Background</span>
              <button id="img-remove-bg-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div class="img-compare-toggle">
              <span class="img-compare-label" data-side="before">Before</span>
              <button id="img-compare-switch" class="img-toggle-switch" role="switch"></button>
              <span class="img-compare-label" data-side="after">After</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Settings + action button (right of canvas) -->
      <aside class="img-sidebar">
        <div class="img-settings">
          <h4 class="img-settings-title">Settings</h4>
          <div class="img-settings-group">
            <span class="sm-label">Rescale</span>
            <label class="sm-switch-row">
              <span class="sm-switch-label">Rescale images</span>
              <button id="img-rescale-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div id="img-rescale-options" class="hidden">
              <div class="sm-size-row">
                <input type="number" id="img-rescale-width" placeholder="Width" min="1">
                <span class="sm-unit">&times;</span>
                <input type="number" id="img-rescale-height" placeholder="Height" min="1">
              </div>
              <label class="sm-check"><input type="checkbox" id="img-rescale-lock-ratio" checked> Lock aspect ratio</label>
            </div>
          </div>
          <div class="img-settings-group">
            <span class="sm-label">Background removal mode</span>
            <button id="img-bg-mode-toggle" class="sm-btn hidden">Mode: Local</button>
            <label class="sm-switch-row hidden" id="img-bg-correction-row">
              <span class="sm-switch-label">Correction</span>
              <button id="img-bg-correction-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div id="img-bg-api-key-row" class="hidden">
              <input type="password" id="img-bg-api-key" placeholder="remove.bg API key" autocomplete="off">
            </div>
          </div>
        </div>
        <button id="img-download-btn" class="img-download-btn disabled">Process</button>
      </aside>
    </div>

    <!-- Hidden file input for image tools -->
    <input id="img-file-input" type="file" multiple accept="image/*" style="display:none">
  </section>

  <!-- Video Editor page -->
  <section id="video-page" class="tool-page hidden">
    <div class="vid-page-header">
      <h2>Video Editor</h2>
      <p>Trim, crop, merge, remove audio, and manage subtitles — everything runs locally.</p>
    </div>

    <div id="vid-layout">
      <!-- Left column: video preview + timeline + controls -->
      <div id="vid-canvas-col">
        <div id="vid-canvas">
          <div id="vid-drop-prompt">
            <svg class="vid-drop-icon" width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="23 7 16 12 23 17 23 7"></polygon>
              <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
            </svg>
            <span class="vid-drop-text">Drop video here</span>
            <span class="vid-drop-sub">or click to browse</span>
          </div>
          <video id="vid-preview" class="hidden"></video>
          <!-- Crop overlay -->
          <div id="vid-crop-overlay" class="hidden">
            <div id="vid-crop-box">
              <div class="vid-crop-handle" data-pos="nw"></div>
              <div class="vid-crop-handle" data-pos="n"></div>
              <div class="vid-crop-handle" data-pos="ne"></div>
              <div class="vid-crop-handle" data-pos="w"></div>
              <div class="vid-crop-handle" data-pos="e"></div>
              <div class="vid-crop-handle" data-pos="sw"></div>
              <div class="vid-crop-handle" data-pos="s"></div>
              <div class="vid-crop-handle" data-pos="se"></div>
            </div>
          </div>
        </div>

        <div id="vid-workspace" class="hidden">
          <div class="vid-timeline-container">
            <div class="vid-timeline">
              <div class="vid-timeline-bar"></div>
              <div class="vid-trim-region">
                <div class="vid-handle vid-handle-left"></div>
                <div class="vid-handle vid-handle-right"></div>
              </div>
              <div class="vid-playhead"></div>
            </div>
          </div>
          <div class="vid-controls">
            <button id="vid-play-btn" class="vid-play-btn" title="Play/Pause">
              <svg class="vid-icon-play" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
              <svg class="vid-icon-pause hidden" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
            </button>
            <span id="vid-time-display" class="vid-time-display">0:00 / 0:00</span>
            <span id="vid-trim-info" class="vid-trim-info"></span>
            <div class="vid-volume-row">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
              <input type="range" id="vid-volume-slider" class="vid-volume-slider" min="0" max="1" step="0.05" value="1">
            </div>
            <button id="vid-fullscreen-btn" class="vid-control-btn" title="Fullscreen">
              <svg class="vid-icon-expand" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3"></path><path d="M21 8V5a2 2 0 0 0-2-2h-3"></path><path d="M3 16v3a2 2 0 0 0 2 2h3"></path><path d="M16 21h3a2 2 0 0 0 2-2v-3"></path></svg>
              <svg class="vid-icon-collapse hidden" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3v3a2 2 0 0 1-2 2H3"></path><path d="M21 8h-3a2 2 0 0 1-2-2V3"></path><path d="M3 16h3a2 2 0 0 1 2 2v3"></path><path d="M16 21v-3a2 2 0 0 1 2-2h3"></path></svg>
            </button>
          </div>
        </div>

        <div id="vid-filmstrip" class="vid-filmstrip hidden">
          <div id="vid-filmstrip-grid" class="vid-filmstrip-grid"></div>
          <button id="vid-add-more" class="vid-filmstrip-add" title="Add more videos">+</button>
        </div>
      </div>

      <!-- Right sidebar: settings + action button -->
      <aside class="vid-sidebar">
        <div class="vid-settings">
          <h4 class="vid-settings-title">Settings</h4>

          <!-- Merge section -->
          <div class="vid-settings-group">
            <div class="vid-collapsible" id="vid-merge-collapsible">
              <button id="vid-merge-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Merge videos</span>
              </button>
              <div id="vid-merge-body" class="vid-collapsible-body">
                <div id="vid-merge-list" class="vid-merge-list"></div>
                <button id="vid-merge-add" class="sm-btn">+ Add video</button>
                <label class="sm-switch-row">
                  <span class="sm-switch-label">Re-encode</span>
                  <button id="vid-merge-reencode" class="sm-switch" role="switch"></button>
                </label>
                <p class="sm-hint">Enable re-encode for files with different codecs.</p>
              </div>
            </div>
          </div>

          <div class="vid-settings-group">
            <div class="vid-collapsible" id="vid-trim-collapsible">
              <button id="vid-trim-col-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Trim</span>
              </button>
              <div class="vid-collapsible-body">
                <div class="vid-trim-inputs">
                  <label class="vid-time-label">
                    <span>Start</span>
                    <input type="text" id="vid-trim-start" placeholder="0:00.000" class="vid-time-input">
                  </label>
                  <label class="vid-time-label">
                    <span>End</span>
                    <input type="text" id="vid-trim-end" placeholder="0:00.000" class="vid-time-input">
                  </label>
                </div>
                <button id="vid-trim-reset" class="sm-btn">Reset trim</button>
              </div>
            </div>
          </div>

          <!-- Crop section -->
          <div class="vid-settings-group">
            <label class="sm-switch-row">
              <span class="sm-switch-label">Crop</span>
              <button id="vid-crop-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div class="vid-crop-presets">
              <button class="vid-crop-preset" data-ratio="16:9">16:9</button>
              <button class="vid-crop-preset" data-ratio="4:3">4:3</button>
              <button class="vid-crop-preset" data-ratio="1:1">1:1</button>
              <button class="vid-crop-preset" data-ratio="9:16">9:16</button>
            </div>
            <label class="sm-switch-row">
              <span class="sm-switch-label">Lock aspect ratio</span>
              <button id="vid-crop-lock-ratio" class="sm-switch" role="switch"></button>
            </label>
            <div class="vid-collapsible" id="vid-crop-manual-collapsible">
              <button id="vid-crop-manual-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Manual crop</span>
              </button>
              <div id="vid-crop-manual-body" class="vid-collapsible-body">
                <div class="vid-crop-inputs">
                  <label class="vid-crop-field">
                    <span>X</span>
                    <input type="number" id="vid-crop-x" min="0" step="2" value="0">
                  </label>
                  <label class="vid-crop-field">
                    <span>Y</span>
                    <input type="number" id="vid-crop-y" min="0" step="2" value="0">
                  </label>
                  <label class="vid-crop-field">
                    <span>W</span>
                    <input type="number" id="vid-crop-w" min="2" step="2" value="0">
                  </label>
                  <label class="vid-crop-field">
                    <span>H</span>
                    <input type="number" id="vid-crop-h" min="2" step="2" value="0">
                  </label>
                </div>
              </div>
            </div>
            <span id="vid-crop-info" class="vid-crop-info"></span>
            <button id="vid-crop-reset" class="sm-btn">Reset crop</button>
          </div>

          <div class="vid-settings-group">
            <span class="sm-label">Audio</span>
            <label class="sm-switch-row">
              <span class="sm-switch-label">Remove audio</span>
              <button id="vid-remove-audio" class="sm-switch" role="switch"></button>
            </label>
            <div class="vid-collapsible" id="vid-eq-collapsible">
              <button id="vid-eq-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Equalizer</span>
              </button>
              <div id="vid-eq-body" class="vid-collapsible-body">
                <div class="vid-eq-bands">
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">60 Hz</span>
                    <input type="range" class="vid-eq-slider" data-freq="60" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">230 Hz</span>
                    <input type="range" class="vid-eq-slider" data-freq="230" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">910 Hz</span>
                    <input type="range" class="vid-eq-slider" data-freq="910" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">3.6k</span>
                    <input type="range" class="vid-eq-slider" data-freq="3600" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">14k</span>
                    <input type="range" class="vid-eq-slider" data-freq="14000" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                </div>
                <button id="vid-eq-reset" class="sm-btn">Reset EQ</button>
              </div>
            </div>
          </div>

          <div class="vid-settings-group">
            <div class="vid-collapsible" id="vid-subs-collapsible">
              <button id="vid-subs-col-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Subtitles</span>
              </button>
              <div class="vid-collapsible-body">
                <div class="vid-extract-row">
                  <select id="vid-sub-lang" class="sm-select vid-lang-select">
                    <option value="all">All tracks</option>
                  </select>
                  <button id="vid-extract-subs" class="sm-btn">Extract</button>
                </div>
                <label class="sm-switch-row">
                  <span class="sm-switch-label">Remove subtitles</span>
                  <button id="vid-remove-subs" class="sm-switch" role="switch"></button>
                </label>
                <div class="vid-collapsible" id="vid-add-subs-collapsible">
                  <button id="vid-add-subs-toggle" class="vid-collapsible-header">
                    <span class="vid-collapsible-arrow">&#9656;</span>
                    <span>Add subtitles</span>
                  </button>
                  <div id="vid-add-subs-body" class="vid-collapsible-body">
                    <button id="vid-sub-file-btn" class="sm-btn">Choose subtitle file</button>
                    <span id="vid-sub-file-name" class="vid-sub-file-name"></span>
                    <label class="sm-switch-row">
                      <span class="sm-switch-label">Mux (embed as track)</span>
                      <button id="vid-mux-toggle" class="sm-switch" role="switch"></button>
                    </label>
                    <label class="sm-switch-row">
                      <span class="sm-switch-label">Burn (hardcode)</span>
                      <button id="vid-burn-toggle" class="sm-switch" role="switch"></button>
                    </label>
                  </div>
                </div>
                <div class="vid-generate-row">
                  <select id="vid-gen-lang" class="sm-select">
                    <option value="">Auto-detect</option>
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="de">German</option>
                    <option value="it">Italian</option>
                    <option value="pt">Portuguese</option>
                    <option value="nl">Dutch</option>
                    <option value="ru">Russian</option>
                    <option value="ja">Japanese</option>
                    <option value="ko">Korean</option>
                    <option value="zh">Chinese</option>
                    <option value="ar">Arabic</option>
                    <option value="hi">Hindi</option>
                    <option value="tr">Turkish</option>
                    <option value="pl">Polish</option>
                    <option value="sv">Swedish</option>
                  </select>
                  <select id="vid-gen-model" class="sm-select">
                    <option value="small">Quality</option>
                    <option value="base">Speed</option>
                  </select>
                </div>
                <button id="vid-generate-subs" class="sm-btn">Generate subtitles (AI)</button>
                <div id="vid-generate-progress" class="vid-generate-progress hidden">
                  <div class="vid-progress-bar"><div class="vid-progress-fill"></div></div>
                  <span class="vid-progress-text">Loading model...</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <button id="vid-download-btn" class="vid-download-btn disabled">Process</button>
      </aside>
    </div>

    <input id="vid-file-input" type="file" multiple accept="video/*" style="display:none">
    <input id="vid-sub-file-input" type="file" accept=".srt,.ass,.vtt,.ssa" style="display:none">
    <input id="vid-merge-file-input" type="file" accept="video/*" multiple style="display:none">
  </section>

  <!-- Speech tool page -->
  <section id="speech-page" class="tool-page hidden">
    <div class="speech-page-header">
      <div class="speech-header-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>
      </div>
      <h2>Text & Speech</h2>
      <p>Convert between text and natural-sounding speech</p>
    </div>

    <div id="speech-layout">
      <div class="speech-tabs">
        <button class="speech-tab active" data-tab="tts">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
          Text to Speech
        </button>
        <button class="speech-tab" data-tab="stt">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg>
          Speech to Text
        </button>
      </div>

      <!-- TTS Panel -->
      <div id="speech-tts-panel" class="speech-panel active">
        <div class="speech-card">
          <!-- Options row (voice + speed) -->
          <div class="speech-tts-options">
            <div class="speech-option-group">
              <label class="speech-option-label">Voice</label>
              <select id="speech-tts-voice" class="sm-select">
                <optgroup label="American English (Female)">
                  <option value="af_heart">Heart</option>
                  <option value="af_alloy">Alloy</option>
                  <option value="af_aoede">Aoede</option>
                  <option value="af_bella">Bella</option>
                  <option value="af_jessica">Jessica</option>
                  <option value="af_kore">Kore</option>
                  <option value="af_nicole">Nicole</option>
                  <option value="af_nova">Nova</option>
                  <option value="af_river">River</option>
                  <option value="af_sarah">Sarah</option>
                  <option value="af_sky">Sky</option>
                </optgroup>
                <optgroup label="American English (Male)">
                  <option value="am_adam">Adam</option>
                  <option value="am_echo">Echo</option>
                  <option value="am_eric">Eric</option>
                  <option value="am_fenrir">Fenrir</option>
                  <option value="am_liam">Liam</option>
                  <option value="am_michael">Michael</option>
                  <option value="am_onyx">Onyx</option>
                  <option value="am_puck">Puck</option>
                  <option value="am_santa">Santa</option>
                </optgroup>
                <optgroup label="British English (Female)">
                  <option value="bf_alice">Alice</option>
                  <option value="bf_emma">Emma</option>
                  <option value="bf_isabella">Isabella</option>
                  <option value="bf_lily">Lily</option>
                </optgroup>
                <optgroup label="British English (Male)">
                  <option value="bm_daniel">Daniel</option>
                  <option value="bm_fable">Fable</option>
                  <option value="bm_george">George</option>
                  <option value="bm_lewis">Lewis</option>
                </optgroup>
              </select>
            </div>
            <div class="speech-option-group">
              <label class="speech-option-label">Speed</label>
              <div class="speech-speed-row">
                <input type="range" id="speech-tts-speed" min="0.5" max="2" step="0.1" value="1">
                <span id="speech-tts-speed-label">1x</span>
              </div>
            </div>
          </div>

          <!-- Main text input -->
          <textarea id="speech-tts-input" class="speech-textarea" placeholder="Type or paste text here..." rows="6"></textarea>

          <button id="speech-tts-generate" class="speech-generate-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
            Generate Audio
          </button>
        </div>

        <div id="speech-tts-progress" class="speech-progress hidden">
          <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
          <span class="speech-progress-text">Generating...</span>
          <p class="speech-freeze-warning hidden">The page may become unresponsive while generating — this is normal.</p>
        </div>

        <!-- Audio Player -->
        <div id="speech-player" class="speech-player hidden">
          <!-- Reader bar — word-by-word display -->
          <div id="speech-word-display" class="speech-word-display"></div>

          <!-- Seek bar with flanking timestamps -->
          <div class="speech-player-seek-row">
            <span id="speech-time-current" class="speech-time-label">0:00</span>
            <div id="speech-seek-bar" class="speech-seek-bar">
              <div id="speech-seek-fill" class="speech-seek-fill"></div>
              <div id="speech-seek-thumb" class="speech-seek-thumb"></div>
            </div>
            <span id="speech-time-duration" class="speech-time-label">0:00</span>
          </div>

          <!-- Control toolbar -->
          <div class="speech-player-toolbar">
            <div class="speech-player-controls">
              <button id="speech-skip-back" class="speech-player-btn" title="Back 10s">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
                <span class="speech-skip-label">10</span>
              </button>
              <button id="speech-play-btn" class="speech-play-btn" title="Play/Pause"></button>
              <button id="speech-skip-forward" class="speech-player-btn" title="Forward 10s">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
                <span class="speech-skip-label">10</span>
              </button>
            </div>
            <div class="speech-player-actions">
              <span id="speech-tts-speed-display" class="speech-speed-display">1x</span>
              <button id="speech-download-mp3" class="speech-download-btn" title="Download MP3">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                MP3
              </button>
            </div>
          </div>

          <audio id="speech-audio" preload="auto"></audio>
        </div>
      </div>

      <!-- STT Panel -->
      <div id="speech-stt-panel" class="speech-panel">
        <div class="speech-stt-modes">
          <button class="speech-stt-mode active" data-mode="mic">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
            Microphone
          </button>
          <button class="speech-stt-mode" data-mode="file">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
            Upload File
          </button>
        </div>

        <!-- Mic mode -->
        <div id="speech-stt-mic" class="speech-stt-content active">
          <div class="speech-card">
            <div class="speech-stt-lang-row">
              <label class="speech-option-label">Language</label>
              <select id="speech-stt-lang" class="sm-select">
                <option value="en-US">English (US)</option>
                <option value="en-GB">English (UK)</option>
                <option value="es-ES">Spanish</option>
                <option value="fr-FR">French</option>
                <option value="de-DE">German</option>
                <option value="it-IT">Italian</option>
                <option value="pt-BR">Portuguese</option>
                <option value="nl-NL">Dutch</option>
                <option value="ru-RU">Russian</option>
                <option value="ja-JP">Japanese</option>
                <option value="ko-KR">Korean</option>
                <option value="zh-CN">Chinese</option>
                <option value="ar-SA">Arabic</option>
                <option value="hi-IN">Hindi</option>
                <option value="pl-PL">Polish</option>
                <option value="sv-SE">Swedish</option>
              </select>
            </div>
            <button id="speech-stt-record" class="speech-record-btn">
              <span class="speech-record-dot"></span>
              Start Recording
            </button>
          </div>
        </div>

        <!-- File upload mode -->
        <div id="speech-stt-file" class="speech-stt-content">
          <div class="speech-card">
            <div id="speech-file-drop" class="speech-file-drop">
              <div class="speech-file-drop-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
              </div>
              <span class="speech-file-drop-text">Drop audio or video file here</span>
              <span class="speech-file-drop-sub">or click to browse</span>
            </div>
            <span id="speech-stt-file-name" class="speech-stt-file-name"></span>
            <div class="speech-stt-options-row">
              <div class="speech-stt-lang-row">
                <label class="speech-option-label">Language</label>
                <select id="speech-stt-file-lang" class="sm-select">
                  <option value="">Auto-detect</option>
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="fr">French</option>
                  <option value="de">German</option>
                  <option value="it">Italian</option>
                  <option value="pt">Portuguese</option>
                  <option value="nl">Dutch</option>
                  <option value="ru">Russian</option>
                  <option value="ja">Japanese</option>
                  <option value="ko">Korean</option>
                  <option value="zh">Chinese</option>
                  <option value="ar">Arabic</option>
                  <option value="hi">Hindi</option>
                  <option value="pl">Polish</option>
                  <option value="sv">Swedish</option>
                </select>
              </div>
              <div id="speech-stt-file-model-row" class="speech-stt-lang-row">
                <label class="speech-option-label">Model</label>
                <select id="speech-stt-file-model" class="sm-select">
                  <option value="small">Quality (small)</option>
                  <option value="base">Speed (base)</option>
                </select>
              </div>
            </div>
            <button id="speech-stt-transcribe" class="speech-generate-btn disabled">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg>
              Transcribe
            </button>
          </div>
          <div id="speech-stt-progress" class="speech-progress hidden">
            <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
            <span class="speech-progress-text">Processing...</span>
          </div>
        </div>

        <!-- STT output (shared by both modes) -->
        <div id="speech-stt-output" class="speech-stt-output hidden">
          <div class="speech-stt-output-header">
            <span class="speech-stt-output-label">Transcription</span>
            <button id="speech-stt-copy" class="speech-copy-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
              Copy
            </button>
          </div>
          <textarea id="speech-stt-result" class="speech-textarea speech-stt-result-textarea" placeholder="Transcribed text will appear here..." rows="6" readonly></textarea>
        </div>
      </div>
    </div>

    <input id="speech-file-input" type="file" accept="audio/*,video/*" style="display:none">
  </section>

  <div id="format-containers">

    <div id="from-container" class="format-container">
      <h2>Convert from:</h2>
      <input type="text" id="search-from" class="search" placeholder="Search">
      <div id="from-list" class="format-list">

      </div>
    </div>

    <div id="to-container" class="format-container">
      <h2>Convert to:</h2>
      <input type="text" id="search-to" class="search" placeholder="Search">
      <div id="to-list" class="format-list">

      </div>
    </div>

  </div>

  <button id="convert-button" class="disabled">Convert</button>

  <div id="popup-bg"></div>
  <div id="popup">
    <h2>Loading tools...</h2>
  </div>

  <script type="module" src="src/main.ts"></script>

</body>
</html>
