<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <title>Convert to it!</title>
</head>
<body>

  <input id="file-input" type="file" multiple>

  <a id="commit-id" href="https://github.com/p2r3/convert"></a>

  <!-- Top bar -->
  <header id="top-bar">
    <div id="top-bar-left">
      <button id="back-to-home" class="hidden" title="Back to home">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
      </button>
      <h1 id="logo">Convert<span class="accent">.</span>it</h1>
    </div>
    <div id="top-bar-right">
      <button id="theme-toggle" title="Toggle dark/light mode">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
      </button>
      <button id="logs-toggle" title="Logs">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
        <span id="log-badge" class="log-badge hidden">0</span>
      </button>
      <button id="settings-toggle" title="Settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </svg>
      </button>
    </div>
  </header>

  <!-- Home page -->
  <section id="home-page">
    <div class="home-hero">
      <h2 class="home-title">What do you want to do?</h2>
      <p class="home-subtitle">Pick a tool to get started — everything runs locally in your browser.</p>
    </div>
    <div class="home-grid">
      <button class="home-card" data-tool="convert">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="16 3 21 3 21 8"></polyline>
            <line x1="4" y1="20" x2="21" y2="3"></line>
            <polyline points="21 16 21 21 16 21"></polyline>
            <line x1="15" y1="15" x2="21" y2="21"></line>
            <line x1="4" y1="4" x2="9" y2="9"></line>
          </svg>
        </div>
        <h3>Convert</h3>
        <p>Change files between 200+ formats — images, video, audio, documents, and more.</p>
        <span class="home-card-tag">Most popular</span>
      </button>
      <button class="home-card" data-tool="compress">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <line x1="4" y1="6" x2="20" y2="6"></line>
            <line x1="6" y1="10" x2="18" y2="10"></line>
            <line x1="8" y1="14" x2="16" y2="14"></line>
            <line x1="10" y1="18" x2="14" y2="18"></line>
          </svg>
        </div>
        <h3>Compress</h3>
        <p>Shrink video file sizes with H.264, H.265, or VP9 — target a specific size or just re-encode.</p>
        <span class="home-card-tag">Video</span>
      </button>
      <button class="home-card" data-tool="image">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <polyline points="21 15 16 10 5 21"></polyline>
          </svg>
        </div>
        <h3>Image Tools</h3>
        <p>Remove backgrounds, rescale dimensions, strip metadata — all processed locally.</p>
        <span class="home-card-tag">AI-powered</span>
      </button>
      <button class="home-card" data-tool="video">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="23 7 16 12 23 17 23 7"></polygon>
            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
          </svg>
        </div>
        <h3>Video Editor</h3>
        <p>Trim, crop, merge, remove audio, and manage subtitles — all processed in your browser.</p>
        <span class="home-card-tag">New</span>
      </button>
      <button class="home-card" data-tool="speech">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
            <line x1="12" y1="19" x2="12" y2="23"></line>
            <line x1="8" y1="23" x2="16" y2="23"></line>
          </svg>
        </div>
        <h3>Text & Speech</h3>
        <p>Read text aloud or transcribe speech to text — all processed locally in your browser.</p>
        <span class="home-card-tag">New</span>
      </button>
      <button class="home-card" data-tool="summarize">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
          </svg>
        </div>
        <h3>Summarize</h3>
        <p>Summarize documents and web pages with AI — everything processed locally.</p>
        <span class="home-card-tag">AI-powered</span>
      </button>
      <button class="home-card" data-tool="ocr">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
            <circle cx="17.5" cy="17.5" r="3.5"></circle>
            <line x1="22" y1="22" x2="20" y2="20"></line>
          </svg>
        </div>
        <h3>OCR</h3>
        <p>Extract text from images and scanned PDFs — powered by Tesseract.js.</p>
        <span class="home-card-tag">AI-powered</span>
      </button>
      <button class="home-card" data-tool="pdf-editor">
        <div class="home-card-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
          </svg>
        </div>
        <h3>PDF Editor</h3>
        <p>Annotate, sign, and edit PDFs directly in your browser.</p>
        <span class="home-card-tag">New</span>
      </button>
    </div>
  </section>

  <!-- Settings modal -->
  <div id="settings-overlay" class="hidden"></div>
  <div id="settings-modal" class="hidden">
    <aside class="sm-sidebar">
      <h2 class="sm-title">Settings</h2>
      <nav class="sm-nav">
        <button class="sm-nav-btn active" data-panel="convert">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
          General
        </button>
        <button class="sm-nav-btn" data-panel="compress">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="6" x2="20" y2="6"></line><line x1="6" y1="10" x2="18" y2="10"></line><line x1="8" y1="14" x2="16" y2="14"></line><line x1="10" y1="18" x2="14" y2="18"></line></svg>
          Compress
        </button>
        <button class="sm-nav-btn" data-panel="image">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
          Image Tools
        </button>
        <button class="sm-nav-btn" data-panel="video">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg>
          Video Editor
        </button>
        <button class="sm-nav-btn" data-panel="speech">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
          Text & Speech
        </button>
        <button class="sm-nav-btn" data-panel="summarize">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line></svg>
          Summarize
        </button>
        <button class="sm-nav-btn" data-panel="ocr">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect><circle cx="17.5" cy="17.5" r="3.5"></circle></svg>
          OCR
        </button>
        <button class="sm-nav-btn" data-panel="pdf-editor">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
          PDF Editor
        </button>
      </nav>
    </aside>
    <main class="sm-content">
      <button id="settings-close-btn" class="modal-close-btn" title="Close">&times;</button>

      <!-- General panel -->
      <div class="sm-panel active" data-panel="convert">
        <h3 class="sm-panel-title">General</h3>
        <div class="sm-group">
          <span class="sm-label">Mode</span>
          <button id="mode-button" class="sm-btn">Advanced mode</button>
        </div>
        <div class="sm-group">
          <span class="sm-label">Output</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Auto-download</span>
            <button id="auto-download-toggle" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Archive multi-file output</span>
            <button id="archive-multi-toggle" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Apply edits to all files</span>
            <button id="apply-all-toggle" class="sm-switch" role="switch"></button>
          </label>
          <p class="sm-hint">When enabled, current settings are applied to every loaded file during processing.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Privacy</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Privacy mode</span>
            <button id="privacy-toggle" class="sm-switch" role="switch"></button>
          </label>
        </div>
        <div class="sm-group">
          <span class="sm-label">Accent color</span>
          <div id="accent-colors">
            <button class="color-dot active" data-color="#6C5CE7" style="background:#6C5CE7" title="Purple"></button>
            <button class="color-dot" data-color="#0984E3" style="background:#0984E3" title="Blue"></button>
            <button class="color-dot" data-color="#00B894" style="background:#00B894" title="Green"></button>
            <button class="color-dot" data-color="#E17055" style="background:#E17055" title="Coral"></button>
            <button class="color-dot" data-color="#FDCB6E" style="background:#FDCB6E" title="Yellow"></button>
            <button class="color-dot" data-color="#E84393" style="background:#E84393" title="Pink"></button>
            <button class="color-dot" data-color="#FF6B6B" style="background:#FF6B6B" title="Red"></button>
            <button class="color-dot" data-color="#1C77FF" style="background:#1C77FF" title="Classic Blue"></button>
          </div>
          <div class="custom-slots-row">
            <span class="custom-slots-label">Custom</span>
            <button class="color-dot custom-slot" id="custom-slot-1" data-slot="1" title="Custom slot 1"></button>
            <button class="color-dot custom-slot" id="custom-slot-2" data-slot="2" title="Custom slot 2"></button>
            <button class="color-dot custom-slot" id="custom-slot-3" data-slot="3" title="Custom slot 3"></button>
          </div>
          <div id="custom-color-row">
            <input type="color" id="custom-accent" value="#6C5CE7">
            <button id="save-custom-color" title="Save current color to a slot">Save</button>
          </div>
        </div>
      </div>

      <!-- Compress panel -->
      <div class="sm-panel" data-panel="compress">
        <h3 class="sm-panel-title">Compress</h3>
        <p class="sm-hint">Re-encodes video at best quality. Set a target size to constrain file size.</p>
        <div id="compress-options">
          <div class="sm-group">
            <span class="sm-label">Codec</span>
            <div class="sm-pill-row">
              <button class="codec-preset-btn selected" data-codec="h264">H.264<span class="sm-pill-note">Compatible</span></button>
              <button class="codec-preset-btn" data-codec="h265">H.265<span class="sm-pill-note">Smaller files</span></button>
            </div>
            <p id="codec-hint" class="sm-hint hidden">H.265 produces ~50% smaller files but may not play on older devices.</p>
          </div>
          <div class="sm-group">
            <span class="sm-label">Speed</span>
            <div class="sm-pill-row">
              <button class="speed-preset-btn" data-speed="fast">Fast<span class="sm-pill-note">Fastest</span></button>
              <button class="speed-preset-btn selected" data-speed="balanced">Balanced<span class="sm-pill-note">Default</span></button>
              <button class="speed-preset-btn" data-speed="quality">Quality<span class="sm-pill-note">Slowest</span></button>
            </div>
          </div>
          <div class="sm-group">
            <span class="sm-label">Output format</span>
            <label class="sm-switch-row">
            <span class="sm-switch-label">WebM mode</span>
            <button id="webm-mode-toggle" class="sm-switch" role="switch"></button>
          </label>
            <p id="webm-hint" class="sm-hint hidden">Tries VP9 first for faster, smaller files. Output will be .webm.</p>
          </div>
          <div class="sm-group">
            <span class="sm-label">Target size</span>
            <div class="sm-size-row">
              <input type="number" id="compress-target-mb" placeholder="Target MB (optional)" min="0.1" step="0.1">
              <span class="sm-unit">MB</span>
            </div>
            <select id="compress-preset-select" class="sm-select">
              <option value="">No preset</option>
              <optgroup label="Discord">
                <option value="10">10 MB — Free</option>
                <option value="50">50 MB — Basic</option>
                <option value="500">500 MB — Nitro</option>
              </optgroup>
              <optgroup label="Twitter / X">
                <option value="15">15 MB — Standard</option>
                <option value="512">512 MB — Premium</option>
              </optgroup>
            </select>
          </div>
        </div>
      </div>

      <!-- Image Tools panel -->
      <div class="sm-panel" data-panel="image">
        <h3 class="sm-panel-title">Image Tools</h3>
        <div class="sm-group">
          <span class="sm-label">Background removal</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Remove background</span>
            <button id="remove-bg-toggle" class="sm-switch" role="switch"></button>
          </label>
          <button id="bg-mode-toggle" class="sm-btn hidden">Mode: Local</button>
          <label class="sm-switch-row hidden">
            <span class="sm-switch-label">Correction</span>
            <button id="bg-correction-toggle" class="sm-switch" role="switch"></button>
          </label>
          <div id="bg-api-key-row" class="hidden">
            <input type="password" id="bg-api-key" placeholder="remove.bg API key" autocomplete="off">
            <p class="sm-hint">Get a free key at <a href="https://www.remove.bg/api" target="_blank" rel="noopener">remove.bg/api</a>. Images are sent to remove.bg servers.</p>
          </div>
        </div>
        <div class="sm-group">
          <span class="sm-label">Rescale</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Rescale images</span>
            <button id="rescale-toggle" class="sm-switch" role="switch"></button>
          </label>
          <div id="rescale-options" class="hidden">
            <div class="sm-size-row">
              <input type="number" id="rescale-width" placeholder="Width" min="1">
              <span class="sm-unit">&times;</span>
              <input type="number" id="rescale-height" placeholder="Height" min="1">
            </div>
            <label class="sm-check"><input type="checkbox" id="rescale-lock-ratio" checked> Lock aspect ratio</label>
          </div>
        </div>
      </div>

      <!-- Text & Speech panel -->
      <div class="sm-panel" data-panel="speech">
        <h3 class="sm-panel-title">Text & Speech</h3>
        <div class="sm-group">
          <span class="sm-label">Default Voice</span>
          <select id="sm-tts-voice" class="sm-select">
            <optgroup label="American English (Female)">
              <option value="af_heart">Heart</option>
              <option value="af_alloy">Alloy</option>
              <option value="af_aoede">Aoede</option>
              <option value="af_bella">Bella</option>
              <option value="af_jessica">Jessica</option>
              <option value="af_kore">Kore</option>
              <option value="af_nicole">Nicole</option>
              <option value="af_nova">Nova</option>
              <option value="af_river">River</option>
              <option value="af_sarah">Sarah</option>
              <option value="af_sky">Sky</option>
            </optgroup>
            <optgroup label="American English (Male)">
              <option value="am_adam">Adam</option>
              <option value="am_echo">Echo</option>
              <option value="am_eric">Eric</option>
              <option value="am_fenrir">Fenrir</option>
              <option value="am_liam">Liam</option>
              <option value="am_michael">Michael</option>
              <option value="am_onyx">Onyx</option>
              <option value="am_puck">Puck</option>
              <option value="am_santa">Santa</option>
            </optgroup>
            <optgroup label="British English (Female)">
              <option value="bf_alice">Alice</option>
              <option value="bf_emma">Emma</option>
              <option value="bf_isabella">Isabella</option>
              <option value="bf_lily">Lily</option>
            </optgroup>
            <optgroup label="British English (Male)">
              <option value="bm_daniel">Daniel</option>
              <option value="bm_fable">Fable</option>
              <option value="bm_george">George</option>
              <option value="bm_lewis">Lewis</option>
            </optgroup>
          </select>
        </div>
        <div class="sm-group">
          <span class="sm-label">Default Speed</span>
          <div class="speech-speed-row">
            <input type="range" id="sm-tts-speed" min="0.5" max="2" step="0.1" value="1">
            <span id="sm-tts-speed-label">1x</span>
          </div>
        </div>
        <div class="sm-group">
          <span class="sm-label">Default STT Model</span>
          <select id="sm-stt-model" class="sm-select">
            <option value="large-v3-turbo">Best — Large V3 Turbo (~1.5 GB)</option>
            <option value="medium">Balanced — Medium (~1 GB)</option>
            <option value="small">Fast — Small (~250 MB)</option>
            <option value="base" selected>Fastest — Base (~75 MB)</option>
          </select>
        </div>
        <div class="sm-group">
          <span class="sm-label">Default STT Language</span>
          <select id="sm-stt-language" class="sm-select">
            <option value="">Auto-detect</option>
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="nl">Dutch</option>
            <option value="ru">Russian</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="zh">Chinese</option>
            <option value="ar">Arabic</option>
            <option value="hi">Hindi</option>
            <option value="pl">Polish</option>
            <option value="sv">Swedish</option>
          </select>
        </div>
        <div class="sm-group">
          <span class="sm-label">Processing</span>
          <p class="sm-hint">TTS uses Kokoro 82M neural model (~92 MB). STT uses Whisper AI locally — model size depends on selection. Everything runs in-browser; no files leave your device.</p>
        </div>
      </div>

      <!-- Summarize panel -->
      <div class="sm-panel" data-panel="summarize">
        <h3 class="sm-panel-title">Summarize</h3>
        <div class="sm-group">
          <span class="sm-label">Summarization Model</span>
          <select id="sm-sum-model" class="sm-select">
            <option value="distilbart-6-6">Fast — DistilBART 6-6 (~300 MB)</option>
            <option value="distilbart-12-6" selected>Balanced — DistilBART 12-6 (~600 MB)</option>
            <option value="bart-large-cnn">Best — BART Large CNN (~1.6 GB)</option>
          </select>
          <p class="sm-hint">Larger models produce better summaries but take longer to download. Models are cached after first use.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Default Word Target</span>
          <div class="sm-size-row">
            <input type="number" id="sm-sum-word-limit" value="150" min="50" max="500" step="10">
            <span class="sm-unit">words</span>
          </div>
        </div>
        <div class="sm-group">
          <span class="sm-label">URL Fetching</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">CORS proxy</span>
            <button id="sm-sum-cors-proxy" class="sm-switch" role="switch"></button>
          </label>
          <p class="sm-hint">Most websites block cross-origin requests. Enable this to route URL fetches through a third-party proxy (allorigins.win). Your requested URL will be sent to that server.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Processing</span>
          <p class="sm-hint">Everything runs in-browser; no files leave your device.</p>
        </div>
      </div>

      <!-- OCR panel -->
      <div class="sm-panel" data-panel="ocr">
        <h3 class="sm-panel-title">OCR</h3>
        <div class="sm-group">
          <span class="sm-label">Default Language</span>
          <select id="sm-ocr-lang" class="sm-select">
            <option value="eng" selected>English</option>
            <option value="spa">Spanish</option>
            <option value="fra">French</option>
            <option value="deu">German</option>
            <option value="ita">Italian</option>
            <option value="por">Portuguese</option>
            <option value="rus">Russian</option>
            <option value="jpn">Japanese</option>
            <option value="kor">Korean</option>
            <option value="chi_sim">Chinese (Simplified)</option>
            <option value="chi_tra">Chinese (Traditional)</option>
            <option value="ara">Arabic</option>
            <option value="hin">Hindi</option>
            <option value="pol">Polish</option>
          </select>
        </div>
        <div class="sm-group">
          <span class="sm-label">Processing</span>
          <p class="sm-hint">Tesseract.js WASM-based OCR. Language data is downloaded on first use (~15 MB per language). Everything runs in-browser; no files leave your device.</p>
        </div>
      </div>

      <!-- PDF Editor panel -->
      <div class="sm-panel" data-panel="pdf-editor">
        <h3 class="sm-panel-title">PDF Editor</h3>
        <div class="sm-group">
          <span class="sm-label">Default Brush Size</span>
          <div class="sm-size-row">
            <input type="number" id="sm-pde-brush-size" value="3" min="1" max="20" step="1">
            <span class="sm-unit">px</span>
          </div>
        </div>
        <div class="sm-group">
          <span class="sm-label">Default Font Size</span>
          <div class="sm-size-row">
            <input type="number" id="sm-pde-font-size" value="16" min="8" max="72" step="1">
            <span class="sm-unit">px</span>
          </div>
        </div>
        <div class="sm-group">
          <span class="sm-label">Processing</span>
          <p class="sm-hint">Uses pdfjs-dist for rendering, Fabric.js for annotations, and pdf-lib for export. Everything runs in-browser; no files leave your device.</p>
        </div>
      </div>

      <!-- Video Editor panel -->
      <div class="sm-panel" data-panel="video">
        <h3 class="sm-panel-title">Video Editor</h3>
        <div class="sm-group">
          <span class="sm-label">Trim</span>
          <p class="sm-hint">Cut video with timeline handles or precise time inputs.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Audio</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Remove audio</span>
            <button id="vid-pref-remove-audio" class="sm-switch" role="switch"></button>
          </label>
          <p class="sm-hint">5-band equalizer available per video in the editor sidebar.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Subtitles</span>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Remove subtitles</span>
            <button id="vid-pref-remove-subs" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Mux as track</span>
            <button id="vid-pref-mux" class="sm-switch" role="switch"></button>
          </label>
          <label class="sm-switch-row">
            <span class="sm-switch-label">Burn onto video</span>
            <button id="vid-pref-burn" class="sm-switch" role="switch"></button>
          </label>
          <p class="sm-hint">Supports SRT, ASS, VTT, and SSA formats.</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">AI subtitle generation</span>
          <select id="vid-pref-gen-model" class="sm-select">
            <option value="small">Quality (small model)</option>
            <option value="base">Speed (base model)</option>
          </select>
          <select id="vid-pref-gen-lang" class="sm-select">
            <option value="">Auto-detect</option>
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="nl">Dutch</option>
            <option value="ru">Russian</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="zh">Chinese</option>
            <option value="ar">Arabic</option>
            <option value="hi">Hindi</option>
            <option value="tr">Turkish</option>
            <option value="pl">Polish</option>
            <option value="sv">Swedish</option>
          </select>
          <p class="sm-hint">Whisper via Transformers.js — model cached on first use (~41 MB).</p>
        </div>
        <div class="sm-group">
          <span class="sm-label">Processing</span>
          <p class="sm-hint">Runs locally via FFmpeg WASM. No files leave your device.</p>
        </div>
      </div>


    </main>
  </div>

  <!-- Logs overlay + modal -->
  <div id="logs-overlay" class="hidden"></div>
  <div id="logs-popout" class="hidden">
    <button id="logs-close-mobile" class="modal-close-btn" title="Close">&times;</button>
    <div class="logs-popout-header">
      <h3>Error Log</h3>
      <button id="logs-popout-close" title="Close">&times;</button>
    </div>
    <p class="sm-hint" style="margin:0 0 8px">Captured <code>console.error</code> and <code>console.warn</code> messages.</p>
    <div id="app-log-list" class="app-log-list"><p class="app-log-empty">No errors or warnings captured yet.</p></div>
    <div class="app-log-actions">
      <button id="copy-log-btn">Copy log</button>
      <button id="clear-log-btn">Clear log</button>
    </div>
  </div>

  <div id="file-area">
    <h2>Click to add your file</h2>
    <p id="drop-hint-text">or drag and drop it here</p>
  </div>

  <div id="archive-panel">
    <span class="archive-panel-title">Archive uploaded files</span>
    <div class="archive-fmt-grid">
      <button class="archive-fmt-btn" data-format="zip">.zip</button>
      <button class="archive-fmt-btn" data-format="7z">.7z</button>
      <button class="archive-fmt-btn" data-format="tar">.tar</button>
      <button class="archive-fmt-btn" data-format="tgz">.tar.gz</button>
      <button class="archive-fmt-btn" data-format="gz">.gz <span class="archive-fmt-note">per file</span></button>
    </div>
    <button id="create-archive-btn" class="disabled">Create Archives</button>
  </div>

  <div id="output-tray">
    <div class="output-tray-header">
      <span>Converted Files</span>
      <div class="output-tray-actions">
        <button id="download-all-btn">Download All</button>
        <button id="clear-output-btn">Clear</button>
      </div>
    </div>
    <div id="output-tray-grid"></div>
  </div>

  <!-- Compress tool page -->
  <section id="compress-page" class="tool-page hidden">
    <div class="tool-page-header">
      <h2>Compress Video</h2>
      <p>Upload your videos and hit compress. <button class="tool-page-settings-link" data-open-panel="compress">Configure settings</button></p>
    </div>
  </section>

  <!-- Image tools page -->
  <section id="image-page" class="tool-page hidden">
    <!-- Title -->
    <div class="img-page-header">
      <h2>Image Tools</h2>
      <p>Upload images to remove backgrounds, rescale, and strip metadata.</p>
    </div>

    <!-- Canvas column + settings side by side, centered -->
    <div id="img-layout">
      <!-- Left column: canvas + filmstrip + controls -->
      <div id="img-canvas-col">
        <div id="img-canvas">
          <div id="img-drop-prompt">
            <svg class="img-drop-icon" width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            <span class="img-drop-text">Drop image here</span>
            <span class="img-drop-sub">or click to browse</span>
          </div>
          <img id="img-preview" class="hidden" alt="Preview">
        </div>

        <!-- Below canvas: filmstrip, remove bg, before/after -->
        <div id="img-workspace" class="hidden">
          <div class="img-filmstrip">
            <div id="img-filmstrip-grid"></div>
            <button id="img-add-more" class="img-filmstrip-add" title="Add more images">+</button>
          </div>
          <div class="img-below-controls">
            <label class="img-removebg-row">
              <span>Remove Background</span>
              <button id="img-remove-bg-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div class="img-compare-toggle">
              <span class="img-compare-label" data-side="before">Before</span>
              <button id="img-compare-switch" class="img-toggle-switch" role="switch"></button>
              <span class="img-compare-label" data-side="after">After</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Settings + action button (right of canvas) -->
      <aside class="img-sidebar">
        <div class="img-settings">
          <h4 class="img-settings-title">Settings</h4>
          <div class="img-settings-group">
            <span class="sm-label">Rescale</span>
            <label class="sm-switch-row">
              <span class="sm-switch-label">Rescale images</span>
              <button id="img-rescale-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div id="img-rescale-options" class="hidden">
              <div class="sm-size-row">
                <input type="number" id="img-rescale-width" placeholder="Width" min="1">
                <span class="sm-unit">&times;</span>
                <input type="number" id="img-rescale-height" placeholder="Height" min="1">
              </div>
              <label class="sm-check"><input type="checkbox" id="img-rescale-lock-ratio" checked> Lock aspect ratio</label>
            </div>
          </div>
          <div class="img-settings-group">
            <span class="sm-label">Background removal mode</span>
            <button id="img-bg-mode-toggle" class="sm-btn hidden">Mode: Local</button>
            <label class="sm-switch-row hidden" id="img-bg-correction-row">
              <span class="sm-switch-label">Correction</span>
              <button id="img-bg-correction-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div id="img-bg-api-key-row" class="hidden">
              <input type="password" id="img-bg-api-key" placeholder="remove.bg API key" autocomplete="off">
            </div>
          </div>
        </div>
        <button id="img-download-btn" class="img-download-btn disabled">Process</button>
      </aside>
    </div>

    <!-- Hidden file input for image tools -->
    <input id="img-file-input" type="file" multiple accept="image/*" style="display:none">
  </section>

  <!-- Video Editor page -->
  <section id="video-page" class="tool-page hidden">
    <div class="vid-page-header">
      <h2>Video Editor</h2>
      <p>Trim, crop, merge, remove audio, and manage subtitles — everything runs locally.</p>
    </div>

    <div id="vid-layout">
      <!-- Left column: video preview + timeline + controls -->
      <div id="vid-canvas-col">
        <div id="vid-canvas">
          <div id="vid-drop-prompt">
            <svg class="vid-drop-icon" width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="23 7 16 12 23 17 23 7"></polygon>
              <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
            </svg>
            <span class="vid-drop-text">Drop video here</span>
            <span class="vid-drop-sub">or click to browse</span>
          </div>
          <video id="vid-preview" class="hidden"></video>
          <!-- Crop overlay -->
          <div id="vid-crop-overlay" class="hidden">
            <div id="vid-crop-box">
              <div class="vid-crop-handle" data-pos="nw"></div>
              <div class="vid-crop-handle" data-pos="n"></div>
              <div class="vid-crop-handle" data-pos="ne"></div>
              <div class="vid-crop-handle" data-pos="w"></div>
              <div class="vid-crop-handle" data-pos="e"></div>
              <div class="vid-crop-handle" data-pos="sw"></div>
              <div class="vid-crop-handle" data-pos="s"></div>
              <div class="vid-crop-handle" data-pos="se"></div>
            </div>
          </div>
        </div>

        <div id="vid-workspace" class="hidden">
          <div class="vid-timeline-container">
            <div class="vid-timeline">
              <div class="vid-timeline-bar"></div>
              <div class="vid-trim-region">
                <div class="vid-handle vid-handle-left"></div>
                <div class="vid-handle vid-handle-right"></div>
              </div>
              <div class="vid-playhead"></div>
            </div>
          </div>
          <div class="vid-controls">
            <button id="vid-play-btn" class="vid-play-btn" title="Play/Pause">
              <svg class="vid-icon-play" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
              <svg class="vid-icon-pause hidden" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
            </button>
            <span id="vid-time-display" class="vid-time-display">0:00 / 0:00</span>
            <span id="vid-trim-info" class="vid-trim-info"></span>
            <div class="vid-volume-row">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
              <input type="range" id="vid-volume-slider" class="vid-volume-slider" min="0" max="1" step="0.05" value="1">
            </div>
            <button id="vid-fullscreen-btn" class="vid-control-btn" title="Fullscreen">
              <svg class="vid-icon-expand" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3"></path><path d="M21 8V5a2 2 0 0 0-2-2h-3"></path><path d="M3 16v3a2 2 0 0 0 2 2h3"></path><path d="M16 21h3a2 2 0 0 0 2-2v-3"></path></svg>
              <svg class="vid-icon-collapse hidden" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3v3a2 2 0 0 1-2 2H3"></path><path d="M21 8h-3a2 2 0 0 1-2-2V3"></path><path d="M3 16h3a2 2 0 0 1 2 2v3"></path><path d="M16 21v-3a2 2 0 0 1 2-2h3"></path></svg>
            </button>
          </div>
        </div>

        <div id="vid-filmstrip" class="vid-filmstrip hidden">
          <div id="vid-filmstrip-grid" class="vid-filmstrip-grid"></div>
          <button id="vid-add-more" class="vid-filmstrip-add" title="Add more videos">+</button>
        </div>
      </div>

      <!-- Right sidebar: settings + action button -->
      <aside class="vid-sidebar">
        <div class="vid-settings">
          <h4 class="vid-settings-title">Settings</h4>

          <!-- Merge section -->
          <div class="vid-settings-group">
            <div class="vid-collapsible" id="vid-merge-collapsible">
              <button id="vid-merge-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Merge videos</span>
              </button>
              <div id="vid-merge-body" class="vid-collapsible-body">
                <div id="vid-merge-list" class="vid-merge-list"></div>
                <button id="vid-merge-add" class="sm-btn">+ Add video</button>
                <label class="sm-switch-row">
                  <span class="sm-switch-label">Re-encode</span>
                  <button id="vid-merge-reencode" class="sm-switch" role="switch"></button>
                </label>
                <p class="sm-hint">Enable re-encode for files with different codecs.</p>
              </div>
            </div>
          </div>

          <div class="vid-settings-group">
            <div class="vid-collapsible" id="vid-trim-collapsible">
              <button id="vid-trim-col-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Trim</span>
              </button>
              <div class="vid-collapsible-body">
                <div class="vid-trim-inputs">
                  <label class="vid-time-label">
                    <span>Start</span>
                    <input type="text" id="vid-trim-start" placeholder="0:00.000" class="vid-time-input">
                  </label>
                  <label class="vid-time-label">
                    <span>End</span>
                    <input type="text" id="vid-trim-end" placeholder="0:00.000" class="vid-time-input">
                  </label>
                </div>
                <button id="vid-trim-reset" class="sm-btn">Reset trim</button>
              </div>
            </div>
          </div>

          <!-- Crop section -->
          <div class="vid-settings-group">
            <label class="sm-switch-row">
              <span class="sm-switch-label">Crop</span>
              <button id="vid-crop-toggle" class="sm-switch" role="switch"></button>
            </label>
            <div class="vid-crop-presets">
              <button class="vid-crop-preset" data-ratio="16:9">16:9</button>
              <button class="vid-crop-preset" data-ratio="4:3">4:3</button>
              <button class="vid-crop-preset" data-ratio="1:1">1:1</button>
              <button class="vid-crop-preset" data-ratio="9:16">9:16</button>
            </div>
            <label class="sm-switch-row">
              <span class="sm-switch-label">Lock aspect ratio</span>
              <button id="vid-crop-lock-ratio" class="sm-switch" role="switch"></button>
            </label>
            <div class="vid-collapsible" id="vid-crop-manual-collapsible">
              <button id="vid-crop-manual-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Manual crop</span>
              </button>
              <div id="vid-crop-manual-body" class="vid-collapsible-body">
                <div class="vid-crop-inputs">
                  <label class="vid-crop-field">
                    <span>X</span>
                    <input type="number" id="vid-crop-x" min="0" step="2" value="0">
                  </label>
                  <label class="vid-crop-field">
                    <span>Y</span>
                    <input type="number" id="vid-crop-y" min="0" step="2" value="0">
                  </label>
                  <label class="vid-crop-field">
                    <span>W</span>
                    <input type="number" id="vid-crop-w" min="2" step="2" value="0">
                  </label>
                  <label class="vid-crop-field">
                    <span>H</span>
                    <input type="number" id="vid-crop-h" min="2" step="2" value="0">
                  </label>
                </div>
              </div>
            </div>
            <span id="vid-crop-info" class="vid-crop-info"></span>
            <button id="vid-crop-reset" class="sm-btn">Reset crop</button>
          </div>

          <div class="vid-settings-group">
            <span class="sm-label">Audio</span>
            <label class="sm-switch-row">
              <span class="sm-switch-label">Remove audio</span>
              <button id="vid-remove-audio" class="sm-switch" role="switch"></button>
            </label>
            <div class="vid-collapsible" id="vid-eq-collapsible">
              <button id="vid-eq-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Equalizer</span>
              </button>
              <div id="vid-eq-body" class="vid-collapsible-body">
                <div class="vid-eq-bands">
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">60 Hz</span>
                    <input type="range" class="vid-eq-slider" data-freq="60" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">230 Hz</span>
                    <input type="range" class="vid-eq-slider" data-freq="230" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">910 Hz</span>
                    <input type="range" class="vid-eq-slider" data-freq="910" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">3.6k</span>
                    <input type="range" class="vid-eq-slider" data-freq="3600" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                  <div class="vid-eq-band">
                    <span class="vid-eq-label">14k</span>
                    <input type="range" class="vid-eq-slider" data-freq="14000" min="-12" max="12" step="1" value="0">
                    <span class="vid-eq-value">0 dB</span>
                  </div>
                </div>
                <button id="vid-eq-reset" class="sm-btn">Reset EQ</button>
              </div>
            </div>
          </div>

          <div class="vid-settings-group">
            <div class="vid-collapsible" id="vid-subs-collapsible">
              <button id="vid-subs-col-toggle" class="vid-collapsible-header">
                <span class="vid-collapsible-arrow">&#9656;</span>
                <span>Subtitles</span>
              </button>
              <div class="vid-collapsible-body">
                <div class="vid-extract-row">
                  <select id="vid-sub-lang" class="sm-select vid-lang-select">
                    <option value="all">All tracks</option>
                  </select>
                  <button id="vid-extract-subs" class="sm-btn">Extract</button>
                </div>
                <label class="sm-switch-row">
                  <span class="sm-switch-label">Remove subtitles</span>
                  <button id="vid-remove-subs" class="sm-switch" role="switch"></button>
                </label>
                <div class="vid-collapsible" id="vid-add-subs-collapsible">
                  <button id="vid-add-subs-toggle" class="vid-collapsible-header">
                    <span class="vid-collapsible-arrow">&#9656;</span>
                    <span>Add subtitles</span>
                  </button>
                  <div id="vid-add-subs-body" class="vid-collapsible-body">
                    <button id="vid-sub-file-btn" class="sm-btn">Choose subtitle file</button>
                    <span id="vid-sub-file-name" class="vid-sub-file-name"></span>
                    <label class="sm-switch-row">
                      <span class="sm-switch-label">Mux (embed as track)</span>
                      <button id="vid-mux-toggle" class="sm-switch" role="switch"></button>
                    </label>
                    <label class="sm-switch-row">
                      <span class="sm-switch-label">Burn (hardcode)</span>
                      <button id="vid-burn-toggle" class="sm-switch" role="switch"></button>
                    </label>
                  </div>
                </div>
                <div class="vid-generate-row">
                  <select id="vid-gen-lang" class="sm-select">
                    <option value="">Auto-detect</option>
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="de">German</option>
                    <option value="it">Italian</option>
                    <option value="pt">Portuguese</option>
                    <option value="nl">Dutch</option>
                    <option value="ru">Russian</option>
                    <option value="ja">Japanese</option>
                    <option value="ko">Korean</option>
                    <option value="zh">Chinese</option>
                    <option value="ar">Arabic</option>
                    <option value="hi">Hindi</option>
                    <option value="tr">Turkish</option>
                    <option value="pl">Polish</option>
                    <option value="sv">Swedish</option>
                  </select>
                  <select id="vid-gen-model" class="sm-select">
                    <option value="small">Quality</option>
                    <option value="base">Speed</option>
                  </select>
                </div>
                <button id="vid-generate-subs" class="sm-btn">Generate subtitles (AI)</button>
                <div id="vid-generate-progress" class="vid-generate-progress hidden">
                  <div class="vid-progress-bar"><div class="vid-progress-fill"></div></div>
                  <span class="vid-progress-text">Loading model...</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <button id="vid-download-btn" class="vid-download-btn disabled">Process</button>
      </aside>
    </div>

    <input id="vid-file-input" type="file" multiple accept="video/*" style="display:none">
    <input id="vid-sub-file-input" type="file" accept=".srt,.ass,.vtt,.ssa" style="display:none">
    <input id="vid-merge-file-input" type="file" accept="video/*" multiple style="display:none">
  </section>

  <!-- Speech tool page -->
  <section id="speech-page" class="tool-page hidden">
    <div class="speech-page-header">
      <div class="speech-header-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>
      </div>
      <h2>Text & Speech</h2>
      <p>Convert between text and natural-sounding speech</p>
    </div>

    <div id="speech-layout">
      <div class="speech-tabs">
        <button class="speech-tab active" data-tab="tts">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
          Text to Speech
        </button>
        <button class="speech-tab" data-tab="stt">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg>
          Speech to Text
        </button>
      </div>

      <!-- TTS Panel -->
      <div id="speech-tts-panel" class="speech-panel active">
        <div class="speech-card">
          <!-- Options row (voice + speed) -->
          <div class="speech-tts-options">
            <div class="speech-option-group">
              <label class="speech-option-label">Voice</label>
              <select id="speech-tts-voice" class="sm-select">
                <optgroup label="American English (Female)">
                  <option value="af_heart">Heart</option>
                  <option value="af_alloy">Alloy</option>
                  <option value="af_aoede">Aoede</option>
                  <option value="af_bella">Bella</option>
                  <option value="af_jessica">Jessica</option>
                  <option value="af_kore">Kore</option>
                  <option value="af_nicole">Nicole</option>
                  <option value="af_nova">Nova</option>
                  <option value="af_river">River</option>
                  <option value="af_sarah">Sarah</option>
                  <option value="af_sky">Sky</option>
                </optgroup>
                <optgroup label="American English (Male)">
                  <option value="am_adam">Adam</option>
                  <option value="am_echo">Echo</option>
                  <option value="am_eric">Eric</option>
                  <option value="am_fenrir">Fenrir</option>
                  <option value="am_liam">Liam</option>
                  <option value="am_michael">Michael</option>
                  <option value="am_onyx">Onyx</option>
                  <option value="am_puck">Puck</option>
                  <option value="am_santa">Santa</option>
                </optgroup>
                <optgroup label="British English (Female)">
                  <option value="bf_alice">Alice</option>
                  <option value="bf_emma">Emma</option>
                  <option value="bf_isabella">Isabella</option>
                  <option value="bf_lily">Lily</option>
                </optgroup>
                <optgroup label="British English (Male)">
                  <option value="bm_daniel">Daniel</option>
                  <option value="bm_fable">Fable</option>
                  <option value="bm_george">George</option>
                  <option value="bm_lewis">Lewis</option>
                </optgroup>
              </select>
            </div>
            <div class="speech-option-group">
              <label class="speech-option-label">Speed</label>
              <div class="speech-speed-row">
                <input type="range" id="speech-tts-speed" min="0.5" max="2" step="0.1" value="1">
                <span id="speech-tts-speed-label">1x</span>
              </div>
            </div>
          </div>

          <!-- Main text input -->
          <textarea id="speech-tts-input" class="speech-textarea" placeholder="Type or paste text here..." rows="6"></textarea>

          <button id="speech-tts-generate" class="speech-generate-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
            Generate Audio
          </button>
        </div>

        <div id="speech-tts-progress" class="speech-progress hidden">
          <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
          <span class="speech-progress-text">Generating...</span>
          <p class="speech-freeze-warning hidden">The page may become unresponsive while generating — this is normal.</p>
        </div>

        <!-- Audio Player -->
        <div id="speech-player" class="speech-player hidden">
          <!-- Reader bar — word-by-word display -->
          <div id="speech-word-display" class="speech-word-display"></div>

          <!-- Seek bar with flanking timestamps -->
          <div class="speech-player-seek-row">
            <span id="speech-time-current" class="speech-time-label">0:00</span>
            <div id="speech-seek-bar" class="speech-seek-bar">
              <div id="speech-seek-fill" class="speech-seek-fill"></div>
              <div id="speech-seek-thumb" class="speech-seek-thumb"></div>
            </div>
            <span id="speech-time-duration" class="speech-time-label">0:00</span>
          </div>

          <!-- Control toolbar -->
          <div class="speech-player-toolbar">
            <div class="speech-player-controls">
              <button id="speech-skip-back" class="speech-player-btn" title="Back 10s">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
                <span class="speech-skip-label">10</span>
              </button>
              <button id="speech-play-btn" class="speech-play-btn" title="Play/Pause"></button>
              <button id="speech-skip-forward" class="speech-player-btn" title="Forward 10s">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
                <span class="speech-skip-label">10</span>
              </button>
            </div>
            <div class="speech-player-actions">
              <span id="speech-tts-speed-display" class="speech-speed-display">1x</span>
              <button id="speech-download-mp3" class="speech-download-btn" title="Download MP3">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                MP3
              </button>
            </div>
          </div>

          <audio id="speech-audio" preload="auto"></audio>
        </div>
      </div>

      <!-- STT Panel -->
      <div id="speech-stt-panel" class="speech-panel">
        <div class="speech-stt-modes">
          <button class="speech-stt-mode active" data-mode="mic">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
            Microphone
          </button>
          <button class="speech-stt-mode" data-mode="file">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
            Upload File
          </button>
        </div>

        <!-- Mic mode -->
        <div id="speech-stt-mic" class="speech-stt-content active">
          <div class="speech-card">
            <div class="speech-stt-options-row">
              <div class="speech-stt-lang-row">
                <label class="speech-option-label">Language</label>
                <select id="speech-stt-lang" class="sm-select">
                  <option value="">Auto-detect</option>
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="fr">French</option>
                  <option value="de">German</option>
                  <option value="it">Italian</option>
                  <option value="pt">Portuguese</option>
                  <option value="nl">Dutch</option>
                  <option value="ru">Russian</option>
                  <option value="ja">Japanese</option>
                  <option value="ko">Korean</option>
                  <option value="zh">Chinese</option>
                  <option value="ar">Arabic</option>
                  <option value="hi">Hindi</option>
                  <option value="pl">Polish</option>
                  <option value="sv">Swedish</option>
                </select>
              </div>
              <div class="speech-stt-lang-row">
                <label class="speech-option-label">Model</label>
                <select id="speech-stt-mic-model" class="sm-select">
                  <option value="large-v3-turbo">Best — Large V3 Turbo (~1.5 GB)</option>
                  <option value="medium">Balanced — Medium (~1 GB)</option>
                  <option value="small">Fast — Small (~250 MB)</option>
                  <option value="base" selected>Fastest — Base (~75 MB)</option>
                </select>
              </div>
            </div>
            <button id="speech-stt-record" class="speech-record-btn">
              <span class="speech-record-dot"></span>
              Start Recording
            </button>
            <div id="speech-stt-mic-progress" class="speech-progress hidden">
              <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
              <span class="speech-progress-text">Processing...</span>
              <p class="speech-freeze-warning hidden">Page may briefly freeze during model initialization...</p>
            </div>
          </div>
        </div>

        <!-- File upload mode -->
        <div id="speech-stt-file" class="speech-stt-content">
          <div class="speech-card">
            <div id="speech-file-drop" class="speech-file-drop">
              <div class="speech-file-drop-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
              </div>
              <span class="speech-file-drop-text">Drop audio or video file here</span>
              <span class="speech-file-drop-sub">or click to browse</span>
            </div>
            <span id="speech-stt-file-name" class="speech-stt-file-name"></span>
            <div class="speech-stt-options-row">
              <div class="speech-stt-lang-row">
                <label class="speech-option-label">Language</label>
                <select id="speech-stt-file-lang" class="sm-select">
                  <option value="">Auto-detect</option>
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="fr">French</option>
                  <option value="de">German</option>
                  <option value="it">Italian</option>
                  <option value="pt">Portuguese</option>
                  <option value="nl">Dutch</option>
                  <option value="ru">Russian</option>
                  <option value="ja">Japanese</option>
                  <option value="ko">Korean</option>
                  <option value="zh">Chinese</option>
                  <option value="ar">Arabic</option>
                  <option value="hi">Hindi</option>
                  <option value="pl">Polish</option>
                  <option value="sv">Swedish</option>
                </select>
              </div>
              <div id="speech-stt-file-model-row" class="speech-stt-lang-row">
                <label class="speech-option-label">Model</label>
                <select id="speech-stt-file-model" class="sm-select">
                  <option value="large-v3-turbo">Best — Large V3 Turbo (~1.5 GB)</option>
                  <option value="medium">Balanced — Medium (~1 GB)</option>
                  <option value="small">Fast — Small (~250 MB)</option>
                  <option value="base" selected>Fastest — Base (~75 MB)</option>
                </select>
              </div>
            </div>
            <button id="speech-stt-transcribe" class="speech-generate-btn disabled">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg>
              Transcribe
            </button>
          </div>
          <div id="speech-stt-progress" class="speech-progress hidden">
            <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
            <span class="speech-progress-text">Processing...</span>
            <p class="speech-freeze-warning hidden">Page may briefly freeze during model initialization...</p>
          </div>
        </div>

        <!-- STT output (shared by both modes) -->
        <div id="speech-stt-output" class="speech-stt-output hidden">
          <div class="speech-stt-output-header">
            <span class="speech-stt-output-label">Transcription</span>
            <button id="speech-stt-copy" class="speech-copy-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
              Copy
            </button>
          </div>
          <textarea id="speech-stt-result" class="speech-textarea speech-stt-result-textarea" placeholder="Transcribed text will appear here..." rows="6" readonly></textarea>
        </div>
      </div>
    </div>

    <input id="speech-file-input" type="file" accept="audio/*,video/*" style="display:none">
  </section>

  <section id="summarize-page" class="tool-page hidden">
    <div class="speech-page-header">
      <div class="speech-header-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      </div>
      <h2>Summarize</h2>
      <p>Extract key points from documents and web pages using AI</p>
    </div>

    <div id="sum-layout">
      <div class="speech-tabs">
        <button class="sum-tab active" data-tab="upload">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          Upload File
        </button>
        <button class="sum-tab" data-tab="text">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 10H3"/><path d="M21 6H3"/><path d="M21 14H3"/><path d="M17 18H3"/></svg>
          Paste Text
        </button>
        <button class="sum-tab" data-tab="url">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
          Enter URL
        </button>
      </div>

      <!-- Upload Panel -->
      <div id="sum-upload-panel" class="sum-panel active">
        <div class="speech-card">
          <div id="sum-file-drop" class="speech-file-drop">
            <div class="speech-file-drop-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
            </div>
            <span class="speech-file-drop-text">Drop a document here</span>
            <span class="speech-file-drop-sub">PDF, DOCX, TXT, MD, HTML</span>
          </div>
          <span id="sum-file-name" class="speech-stt-file-name"></span>

          <div class="sum-word-limit-row">
            <label class="speech-option-label">Word target</label>
            <input type="number" id="sum-word-limit" class="sum-word-limit-input" value="150" min="50" max="500" step="10">
          </div>

          <button id="sum-summarize-btn" class="speech-generate-btn disabled">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            Summarize
          </button>
        </div>
      </div>

      <!-- Text Panel -->
      <div id="sum-text-panel" class="sum-panel">
        <div class="speech-card">
          <textarea id="sum-text-input" class="speech-textarea" placeholder="Paste or type your text here..." rows="8"></textarea>

          <div class="sum-word-limit-row">
            <label class="speech-option-label">Word target</label>
            <input type="number" class="sum-word-limit-input sum-text-word-limit" value="150" min="50" max="500" step="10">
          </div>

          <button class="speech-generate-btn disabled sum-text-summarize-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            Summarize
          </button>
        </div>
      </div>

      <!-- URL Panel -->
      <div id="sum-url-panel" class="sum-panel">
        <div class="speech-card">
          <div class="sum-url-row">
            <input type="url" id="sum-url-input" class="sum-url-field" placeholder="https://example.com/article">
            <button id="sum-fetch-btn" class="sum-fetch-btn">Fetch</button>
          </div>

          <div class="sum-word-limit-row">
            <label class="speech-option-label">Word target</label>
            <input type="number" class="sum-word-limit-input sum-url-word-limit" value="150" min="50" max="500" step="10">
          </div>

          <button class="speech-generate-btn disabled sum-url-summarize-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            Summarize
          </button>
        </div>
      </div>

      <!-- Progress -->
      <div id="sum-progress" class="speech-progress hidden">
        <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
        <span class="speech-progress-text">Processing...</span>
      </div>

      <!-- Output -->
      <div id="sum-output" class="speech-stt-output hidden">
        <div class="speech-stt-output-header">
          <span class="speech-stt-output-label">Summary</span>
          <div class="sum-output-actions">
            <button id="sum-copy-btn" class="speech-copy-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
              Copy
            </button>
            <button id="sum-download-btn" class="speech-copy-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
              Download
            </button>
            <button id="sum-read-aloud-btn" class="speech-copy-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
              Read Aloud
            </button>
          </div>
        </div>
        <textarea id="sum-result" class="speech-textarea speech-stt-result-textarea" placeholder="Summary will appear here..." rows="6" readonly></textarea>

        <!-- Read Aloud: TTS progress + player -->
        <div id="sum-tts-progress" class="speech-progress hidden">
          <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
          <span class="speech-progress-text">Loading TTS model...</span>
          <p class="speech-freeze-warning hidden">The page may become unresponsive while generating — this is normal.</p>
        </div>

        <div id="sum-tts-player" class="speech-player hidden">
          <div id="sum-word-display" class="speech-word-display"></div>
          <div class="speech-player-seek-row">
            <span id="sum-time-current" class="speech-time-label">0:00</span>
            <div id="sum-seek-bar" class="speech-seek-bar">
              <div id="sum-seek-fill" class="speech-seek-fill"></div>
              <div id="sum-seek-thumb" class="speech-seek-thumb"></div>
            </div>
            <span id="sum-time-duration" class="speech-time-label">0:00</span>
          </div>
          <div class="speech-player-toolbar">
            <div class="speech-player-controls">
              <button id="sum-skip-back" class="speech-player-btn" title="Back 10s">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
                <span class="speech-skip-label">10</span>
              </button>
              <button id="sum-play-btn" class="speech-play-btn" title="Play/Pause"></button>
              <button id="sum-skip-forward" class="speech-player-btn" title="Forward 10s">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
                <span class="speech-skip-label">10</span>
              </button>
            </div>
          </div>
          <audio id="sum-tts-audio" preload="auto"></audio>
        </div>
      </div>
    </div>

    <input id="sum-file-input" type="file" accept=".pdf,.docx,.txt,.md,.html,.htm,.csv,.json,.xml,.log,.yaml,.yml,.toml,.ini,.cfg,.conf" style="display:none">
  </section>

  <!-- OCR tool page -->
  <section id="ocr-page" class="tool-page hidden">
    <div id="ocr-layout">
      <!-- Toolbar: file input + language + extract -->
      <div class="ocr-toolbar">
        <div id="ocr-drop-area" class="ocr-file-btn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <polyline points="21 15 16 10 5 21"></polyline>
          </svg>
          <span id="ocr-drop-text">Choose file or drop here</span>
        </div>
        <select id="ocr-lang" class="sm-select ocr-lang-select">
          <option value="eng" selected>English</option>
          <option value="spa">Spanish</option>
          <option value="fra">French</option>
          <option value="deu">German</option>
          <option value="ita">Italian</option>
          <option value="por">Portuguese</option>
          <option value="rus">Russian</option>
          <option value="jpn">Japanese</option>
          <option value="kor">Korean</option>
          <option value="chi_sim">Chinese (Simplified)</option>
          <option value="chi_tra">Chinese (Traditional)</option>
          <option value="ara">Arabic</option>
          <option value="hin">Hindi</option>
          <option value="pol">Polish</option>
        </select>
        <button id="ocr-extract-btn" class="ocr-extract-btn disabled">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect><circle cx="17.5" cy="17.5" r="3.5"></circle></svg>
          Extract Text
        </button>
        <button class="ocr-settings-btn tool-page-settings-link" data-open-panel="ocr" title="Settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
        </button>
      </div>

      <!-- Progress bar (spans full width) -->
      <div id="ocr-progress" class="ocr-progress-bar hidden">
        <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
        <span class="speech-progress-text">Processing...</span>
      </div>

      <!-- Main content: two panes -->
      <div class="ocr-panes">
        <!-- Left pane: source preview -->
        <div class="ocr-source-pane">
          <div id="ocr-empty-state" class="ocr-empty-state">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" opacity="0.3">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            <span>Upload an image or PDF to preview</span>
          </div>
          <div id="ocr-preview" class="ocr-preview hidden">
            <img id="ocr-preview-img" alt="Uploaded file preview">
          </div>
          <div id="ocr-pdf-preview" class="ocr-pdf-preview hidden"></div>
        </div>

        <!-- Right pane: output -->
        <div class="ocr-result-pane">
          <div class="ocr-result-header">
            <span class="speech-stt-output-label">Extracted Text</span>
            <div class="sum-output-actions">
              <button id="ocr-copy-btn" class="speech-copy-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                Copy
              </button>
              <button id="ocr-download-btn" class="speech-copy-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                Download
              </button>
              <button id="ocr-read-aloud-btn" class="speech-copy-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
                Read Aloud
              </button>
            </div>
          </div>
          <textarea id="ocr-result" class="speech-textarea ocr-result-textarea" placeholder="Extracted text will appear here..." readonly></textarea>

          <!-- Read Aloud: TTS progress (inline) -->
          <div id="ocr-tts-progress" class="speech-progress hidden">
            <div class="speech-progress-bar"><div class="speech-progress-fill"></div></div>
            <span class="speech-progress-text">Loading TTS model...</span>
            <p class="speech-freeze-warning hidden">The page may become unresponsive while generating — this is normal.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Read Aloud fullscreen overlay -->
    <div id="ocr-tts-overlay" class="ocr-tts-overlay hidden">
      <!-- Main scrollable text body -->
      <div class="ocr-tts-body">
        <div id="ocr-word-display" class="speech-word-display ocr-tts-word-display"></div>
      </div>

      <!-- Bottom bar: current sentence + controls -->
      <div class="ocr-tts-bottom">
        <div id="ocr-tts-sentence" class="ocr-tts-sentence"></div>
        <div class="ocr-tts-controls">
          <button id="ocr-tts-close" class="ocr-tts-close-btn" title="Try Another">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
            Try Another
          </button>
          <div class="ocr-tts-transport">
            <button id="ocr-skip-back" class="speech-player-btn" title="Back 10s">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
              <span class="speech-skip-label">10</span>
            </button>
            <button id="ocr-play-btn" class="speech-play-btn" title="Play/Pause"></button>
            <button id="ocr-skip-forward" class="speech-player-btn" title="Forward 10s">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
              <span class="speech-skip-label">10</span>
            </button>
          </div>
          <button id="ocr-download-audio-btn" class="ocr-download-audio-btn" title="Download Audio">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
            Download Audio
          </button>
        </div>
        <div class="speech-player-seek-row ocr-tts-seek">
          <span id="ocr-time-current" class="speech-time-label">0:00</span>
          <div id="ocr-seek-bar" class="speech-seek-bar">
            <div id="ocr-seek-fill" class="speech-seek-fill"></div>
            <div id="ocr-seek-thumb" class="speech-seek-thumb"></div>
          </div>
          <span id="ocr-time-duration" class="speech-time-label">0:00</span>
        </div>
      </div>
      <audio id="ocr-tts-audio" preload="auto"></audio>
    </div>

    <input id="ocr-file-input" type="file" accept="image/*,.pdf" style="display:none">
  </section>

  <!-- PDF Editor tool page -->
  <section id="pdf-editor-page" class="tool-page hidden">
    <div class="speech-page-header">
      <div class="speech-page-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
      </div>
      <h2>PDF Editor</h2>
      <p>Annotate, sign, and edit PDFs. <button class="tool-page-settings-link" data-open-panel="pdf-editor">Configure settings</button></p>
    </div>

    <!-- Upload state -->
    <div id="pde-upload" class="pde-upload-card">
      <div id="pde-drop-area" class="pde-drop-zone">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
        </svg>
        <span id="pde-drop-text">Drop a PDF here, or click to browse</span>
      </div>
    </div>

    <!-- Editor (hidden until PDF loaded) -->
    <div id="pde-editor" class="hidden">
      <!-- Toolbar -->
      <div class="pde-toolbar">
        <div class="pde-toolbar-group">
          <button class="pde-tool-btn active" data-pde-tool="select" title="Select">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/></svg>
            <span>Select</span>
          </button>
          <button class="pde-tool-btn" data-pde-tool="text" title="Add Text">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 7 4 4 20 4 20 7"></polyline><line x1="9" y1="20" x2="15" y2="20"></line><line x1="12" y1="4" x2="12" y2="20"></line></svg>
            <span>Text</span>
          </button>
          <button class="pde-tool-btn" data-pde-tool="draw" title="Draw / Sign">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19l7-7 3 3-7 7-3-3z"></path><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path><path d="M2 2l7.586 7.586"></path><circle cx="11" cy="11" r="2"></circle></svg>
            <span>Draw</span>
          </button>
          <button class="pde-tool-btn" data-pde-tool="highlight" title="Highlight">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="8" width="18" height="8" rx="1"></rect></svg>
            <span>Highlight</span>
          </button>
          <button class="pde-tool-btn" data-pde-tool="erase" title="Erase / Redact">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="7" y1="7" x2="17" y2="17"/><line x1="17" y1="7" x2="7" y2="17"/></svg>
            <span>Erase</span>
          </button>
          <button class="pde-tool-btn" data-pde-tool="image" title="Add Image">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
            <span>Image</span>
          </button>
        </div>
        <div class="pde-toolbar-sep"></div>
        <div class="pde-toolbar-group">
          <button id="pde-undo" class="pde-tool-btn" title="Undo" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
          </button>
          <button id="pde-redo" class="pde-tool-btn" title="Redo" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
          </button>
          <button id="pde-delete-obj" class="pde-tool-btn" title="Delete selected" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
          </button>
        </div>
        <div class="pde-toolbar-spacer"></div>
        <button id="pde-download" class="pde-download-btn" title="Download PDF">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
          <span>Download</span>
        </button>
      </div>

      <!-- Workspace: 3-column layout -->
      <div class="pde-workspace">
        <!-- Left sidebar: Page thumbnails -->
        <aside class="pde-sidebar pde-sidebar-left">
          <div class="pde-sidebar-header"><span>Pages</span></div>
          <div class="pde-thumb-list" id="pde-thumbnails"></div>
        </aside>

        <!-- Center: Canvas -->
        <main class="pde-main">
          <div id="pde-canvas-wrap">
            <div id="pde-canvas-inner">
              <canvas id="pde-bg-canvas"></canvas>
              <canvas id="pde-fabric-canvas"></canvas>
            </div>
          </div>
          <!-- Bottom bar: page nav + zoom -->
          <div class="pde-bottom-bar">
            <button id="pde-prev" class="pde-nav-btn" title="Previous page" disabled>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
            </button>
            <span id="pde-page-info">Page 1 / 1</span>
            <button id="pde-next" class="pde-nav-btn" title="Next page" disabled>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
            </button>
            <div class="pde-toolbar-sep"></div>
            <button id="pde-zoom-out" class="pde-nav-btn" title="Zoom out">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
            <span id="pde-zoom-label">100%</span>
            <button id="pde-zoom-in" class="pde-nav-btn" title="Zoom in">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </button>
          </div>
        </main>

        <!-- Right sidebar: Properties -->
        <aside class="pde-sidebar pde-sidebar-right">
          <div class="pde-sidebar-header"><span>Properties</span></div>
          <div class="pde-props-body">
            <!-- Color -->
            <div class="pde-prop-group">
              <label class="pde-prop-label">Color</label>
              <div class="pde-prop-row">
                <input type="color" id="pde-color" value="#000000">
                <span id="pde-color-hex" class="pde-color-hex">#000000</span>
              </div>
            </div>
            <!-- Text properties -->
            <div id="pde-text-props" class="pde-prop-group">
              <label class="pde-prop-label">Font</label>
              <select id="pde-font-family" class="pde-select">
                <option value="Arial">Arial</option>
                <option value="Book Antiqua">Book Antiqua</option>
                <option value="Bookman Old Style">Bookman Old Style</option>
                <option value="Calibri">Calibri</option>
                <option value="Cambria">Cambria</option>
                <option value="Comic Sans MS">Comic Sans MS</option>
                <option value="Consolas">Consolas</option>
                <option value="Courier New">Courier New</option>
                <option value="Garamond">Garamond</option>
                <option value="Georgia">Georgia</option>
                <option value="Helvetica">Helvetica</option>
                <option value="Impact">Impact</option>
                <option value="Lucida Console">Lucida Console</option>
                <option value="Lucida Sans Unicode">Lucida Sans Unicode</option>
                <option value="Palatino Linotype">Palatino Linotype</option>
                <option value="Segoe UI">Segoe UI</option>
                <option value="Tahoma">Tahoma</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Trebuchet MS">Trebuchet MS</option>
                <option value="Verdana">Verdana</option>
              </select>
              <div class="pde-prop-row">
                <input type="number" id="pde-font-size" min="8" max="120" value="16" class="pde-size-input">
                <span class="pde-prop-unit">px</span>
              </div>
              <div class="pde-style-row">
                <button id="pde-bold" class="pde-style-btn" title="Bold"><strong>B</strong></button>
                <button id="pde-italic" class="pde-style-btn" title="Italic"><em>I</em></button>
                <button id="pde-underline" class="pde-style-btn" title="Underline"><span style="text-decoration:underline">U</span></button>
                <button id="pde-strikethrough" class="pde-style-btn" title="Strikethrough"><span style="text-decoration:line-through">S</span></button>
                <button id="pde-bullet" class="pde-style-btn" title="Bullet List">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="9" y1="6" x2="21" y2="6"/><line x1="9" y1="12" x2="21" y2="12"/><line x1="9" y1="18" x2="21" y2="18"/><circle cx="4" cy="6" r="1.5" fill="currentColor" stroke="none"/><circle cx="4" cy="12" r="1.5" fill="currentColor" stroke="none"/><circle cx="4" cy="18" r="1.5" fill="currentColor" stroke="none"/></svg>
                </button>
              </div>
              <label class="pde-prop-label">Align</label>
              <div class="pde-align-row">
                <button class="pde-style-btn active" data-pde-align="left" title="Align left">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="15" y2="12"/><line x1="3" y1="18" x2="18" y2="18"/></svg>
                </button>
                <button class="pde-style-btn" data-pde-align="center" title="Center">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="6" y1="12" x2="18" y2="12"/><line x1="4" y1="18" x2="20" y2="18"/></svg>
                </button>
                <button class="pde-style-btn" data-pde-align="right" title="Align right">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="9" y1="12" x2="21" y2="12"/><line x1="6" y1="18" x2="21" y2="18"/></svg>
                </button>
              </div>
              <button id="pde-match-text" class="pde-match-btn" title="Match font, size and color from nearby PDF text">Match Surrounding Text</button>
            </div>
            <!-- Draw properties -->
            <div id="pde-draw-props" class="pde-prop-group" style="display:none">
              <label class="pde-prop-label">Brush Size</label>
              <div class="pde-prop-row">
                <input type="range" id="pde-brush-size" min="1" max="20" value="3" class="pde-range">
                <span id="pde-brush-label" class="pde-range-label">3px</span>
              </div>
            </div>
            <!-- Erase properties -->
            <div id="pde-erase-props" class="pde-prop-group" style="display:none">
              <label class="pde-prop-label">Fill Color</label>
              <div class="pde-prop-row">
                <input type="color" id="pde-erase-color" value="#ffffff">
                <span id="pde-erase-color-hex" class="pde-color-hex">#ffffff</span>
                <button id="pde-erase-pick" class="pde-style-btn" title="Pick color from PDF">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 22l1-1h3l9-9-3-3-9 9v3l-1 1z"/><path d="M14.5 6.5l3-3a1.41 1.41 0 0 1 2 0l1 1a1.41 1.41 0 0 1 0 2l-3 3"/></svg>
                </button>
              </div>
              <p class="pde-prop-hint">Click &amp; drag to cover content. Use the eyedropper to match the background color.</p>
            </div>
            <!-- Opacity -->
            <div class="pde-prop-group">
              <label class="pde-prop-label">Opacity</label>
              <div class="pde-prop-row">
                <input type="range" id="pde-opacity" min="0" max="100" value="100" class="pde-range">
                <span id="pde-opacity-label" class="pde-range-label">100%</span>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <input id="pde-file-input" type="file" accept=".pdf" style="display:none">
    <input id="pde-img-input" type="file" accept="image/*" style="display:none">
  </section>

  <div id="format-containers">

    <div id="from-container" class="format-container">
      <h2>Convert from:</h2>
      <input type="text" id="search-from" class="search" placeholder="Search">
      <div id="from-list" class="format-list">

      </div>
    </div>

    <div id="to-container" class="format-container">
      <h2>Convert to:</h2>
      <input type="text" id="search-to" class="search" placeholder="Search">
      <div id="to-list" class="format-list">

      </div>
    </div>

  </div>

  <button id="convert-button" class="disabled">Convert</button>

  <div id="popup-bg"></div>
  <div id="popup">
    <h2>Loading tools...</h2>
  </div>

  <script type="module" src="src/main.ts"></script>

</body>
</html>
